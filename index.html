<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2H559N5J64"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2H559N5J64');
</script>
    <meta charset="UTF-8">
    <title>Idle BTC Miner | GAME</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --btc: #f7931a; --bg: #050505; --panel: #111; --green: #00ff88; --red: #ff3344; --border: #222; }
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); color: #fff; margin: 0; padding: 20px; overflow: hidden; height: 100vh; box-sizing: border-box; }
        
        #main-layout { display: grid; grid-template-columns: 7fr 3fr; gap: 20px; height: calc(100vh - 40px); }
        .panel { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; display: flex; flex-direction: column; padding: 24px; position: relative; overflow: hidden; }
        
        .nw-label { font-size: 1.2rem; color: #555; text-transform: uppercase; letter-spacing: 3px; font-weight: 700; }
        .nw-amount { 
            font-size: 4.5rem; 
            font-weight: 950; 
            color: var(--green); 
            font-family: monospace; 
            line-height: 1; 
            margin: 8px 0; 
            letter-spacing: -3px; 
            white-space: nowrap;
        }
        .btc-stat { font-size: 2.2rem; color: var(--btc); font-weight: bold; font-family: monospace; border-bottom: 2px solid var(--border); padding-bottom: 12px; margin-bottom: 25px; }

        /* Restoring the 2-column feel for the first two, but allowing the 3rd to be wide */
        .mini-stats { display: flex; justify-content: space-between; gap: 30px; margin-bottom: 15px; }
        .stat-item { flex: 1; }
        .stat-item:last-child { flex: 1.5; } /* Give more room to the long BTC string */
        
        .stat-item span { font-size: 0.9rem; color: #777; text-transform: uppercase; display: block; margin-bottom: 5px; font-weight: 800; }
        
        .stat-val { 
            font-size: 2.8rem !important; /* BACK TO BIG FONT */
            color: #ffffff; 
            font-family: monospace; 
            display: flex; 
            align-items: center; 
            line-height: 1;
            font-weight: 900;
            letter-spacing: -2px;
            white-space: nowrap;
        }

        .chart-container { 
            flex: 1; 
            min-height: 0; 
            background: rgba(0,0,0,0.3); 
            border-radius: 8px; 
            border: 1px solid #1a1a1a; 
            position: relative;
            margin-top: 10px;
            padding: 10px;
        }

        .mine-btn { background: var(--btc); color: #000; border: none; width: 100%; padding: 20px; font-weight: 900; border-radius: 10px; cursor: pointer; transition: 0.1s; font-size: 1rem; margin-bottom: 15px; }
        .upgrade-list { flex: 1; overflow-y: auto; padding-right: 5px; }
        .u-item { background: #181818; border: 1px solid #252525; border-radius: 10px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; width: 100%; color: #fff; }

/* 1. THE GENERAL HOVER (Works for all standard miners) */
.u-item:hover:not(:disabled) {
    border-color: var(--btc) !important;
    box-shadow: 0 0 15px rgba(247, 147, 26, 0.4) !important;
    transition: box-shadow 0.2s ease;
}
/* 1. HOVER: Only the main mining button glows */
.mine-btn:hover {
    box-shadow: 0 0 25px rgba(247, 147, 26, 0.6); /* Strong orange glow */
    cursor: pointer;
    filter: brightness(1.1); /* Makes it look slightly 'lit up' */
}

/* 2. CLICK: Only the main mining button moves */
.mine-btn:active {
    transform: scale(0.96) translateY(2px); /* Squishes down and moves slightly */
    box-shadow: 0 0 10px rgba(247, 147, 26, 0.3); /* Shrinks the glow on press */
}

/* Ensure a smooth transition for the effects */
.mine-btn {
    transition: transform 0.05s, box-shadow 0.2s, filter 0.2s;
}
/* 2. MANUAL HASH BASE (The white border) */
#up-0.u-item {
    background: var(--btc) !important;
    border: none !important;
    box-shadow: inset 0 0 0 3px #ffffff !important;
    padding: 15px !important; 
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    border-radius: 10px;
}

/* 3. MANUAL HASH HOVER (The white glow) */
/* We use a comma to keep BOTH the inner white line AND the outer glow */
#up-0.u-item:hover:not(:disabled) {
    background: #ffaa44 !important;
    box-shadow: inset 0 0 0 3px #ffffff, 0 0 20px rgba(255, 255, 255, 0.7) !important;
}

/* 4. KEEP THE TEXT WHITE */
#up-0.u-item #lvl-txt-0 {
    color: #ffffff !important;
}   .u-item:disabled { opacity: 0.2; cursor: not-allowed; }

        
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #333; }
    </style>
</head>
<body>

    <div id="main-layout">
        <div class="panel">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                <span class="nw-label">Portfolio Valuation</span>
                <span style="font-size: 0.6rem; color: #555;">Idle BTC Miner™ 2026 - Aaron Khan</span>
            </div>
            <div class="nw-amount" id="nw-val">$0.00</div>
            <div class="btc-stat">₿ <span id="bal-btc">0.00000000</span></div>

            <div class="mini-stats">
                <div class="stat-item">
                    <span>Hardware Equity</span>
                    <b class="stat-val" id="asset-usd">$0</b>
                </div>
                <div class="stat-item">
                    <span>Hashrate</span>
                    <b class="stat-val" id="yield-btc">0.00/s</b>
                </div>
                <div class="stat-item">
                    <span>Lifetime Mined</span>
                    <b class="stat-val" style="font-size: 48px;">₿<span id="lifetime-btc" style="font-size: 48px; color: white;">0.00013000</span>
</b>

                </div>
            </div>

            <div class="chart-container">
                <canvas id="nwChart"></canvas>
            </div>
        </div>

        <div class="panel">
            <button class="mine-btn" onclick="manualHash()">MANUAL HASH<br>
                <span style="font-size: 1.25rem; font-weight: normal; opacity: 0.7;">+0.00000250 ₿</span>
            </button>
            <div class="upgrade-list" id="shop"></div>
            <button style="background: #ff3344; color: white; border: none; width: 100%; padding: 10px; font-weight: 700; border-radius: 10px; cursor: pointer; margin-top: 15px; font-size: 0.9rem;" onclick="resetGame()">RESET SAVE</button>
        </div>
    </div>

<script>
    let btcPrice = 96450;
    let btcBalance = 0;
    let btcLifetime = 0;
    let btcPerSec = 0;
let btcClickValue = 0.00000250;
    let hardwareEquity = 0;
    let lastTickTime = Date.now();
    const MIN_PRICE = 50000;
    const MAX_PRICE = 200000;

    // Fetch BTC price from API
    async function fetchBTCPrice() {
        try {
            const today = new Date().toISOString().split('T')[0];
            const response = await fetch(`https://api.api-ninjas.com/v1/cryptopricehistorical?symbol=BTC&date=${today}`, {
                headers: { 'X-Api-Key': 'xcO8LVjVU8BBeRwySvx0q3bkHPqKX5PhNtPo5JNM' }
            });
            if (response.ok) {
                const data = await response.json();
                if (data.data && data.data.length > 0) {
                    btcPrice = data.data[0].price;
                    console.log('Updated BTC price from API:', btcPrice);
                    updateUI();
                }
            }
        } catch (error) {
            console.log('Could not fetch BTC price, using default');
        }
    }

    // Sound effects using Web Audio API
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();

    function playClickSound() {
        const now = audioContext.currentTime;
        const osc = audioContext.createOscillator();
        const gain = audioContext.createGain();
        osc.connect(gain);
        gain.connect(audioContext.destination);

        osc.frequency.setValueAtTime(800, now);
        osc.frequency.exponentialRampToValueAtTime(600, now + 0.1);
        osc.type = 'sine';

        gain.gain.setValueAtTime(0.05, now);
        gain.gain.exponentialRampToValueAtTime(0.001, now + 0.1);

        osc.start(now);
        osc.stop(now + 0.1);
    }

    function playUpgradeSound() {
        const now = audioContext.currentTime;
        const osc = audioContext.createOscillator();
        const gain = audioContext.createGain();
        osc.connect(gain);
        gain.connect(audioContext.destination);

        osc.frequency.setValueAtTime(500, now);
        osc.frequency.exponentialRampToValueAtTime(1200, now + 0.2);
        osc.type = 'square';

        gain.gain.setValueAtTime(0.04, now);
        gain.gain.exponentialRampToValueAtTime(0.001, now + 0.2);

        osc.start(now);
        osc.stop(now + 0.2);
    }

    const upgrades = [
	{ id: 0, name: "Manual Hash Upgrade", baseUsd: 5, baseYield: 0, isClickUpgrade: true, clickIncrease: 0.00000050 }, // NEW BUTTON
        { id: 1, name: "USB Miner", baseUsd: 5, baseYield: 0.000000115 }, 
        { id: 2, name: "GTX 1660 Super", baseUsd: 100, baseYield: 0.0000007 },
        { id: 3, name: "RTX 5090 Rig", baseUsd: 3000, baseYield: 0.000015 },
        { id: 4, name: "ASIC Mining Unit", baseUsd: 7500, baseYield: 0.000085 },
        { id: 5, name: "Liquid ASIC Rig", baseUsd: 28000, baseYield: 0.00045 },
        { id: 6, name: "Mobile Mining Container", baseUsd: 110000, baseYield: 0.0032 },
        { id: 7, name: "Geothermal Mining Farm", baseUsd: 680000, baseYield: 0.045 },
        { id: 8, name: "Data Center Facility", baseUsd: 5200000, baseYield: 0.62 },
        { id: 9, name: "Orbital Data Relay", baseUsd: 35000000, baseYield: 5.8 },
        { id: 10, name: "Quantum Computer", baseUsd: 500000000, baseYield: 125.0 }
    ].map(u => ({ ...u, level: 0, currentUsd: u.baseUsd, currentYield: 0, boostCost: u.baseUsd * 0.5, boostLevel: 0 }));

    // --- SAVE SYSTEM START ---
    function saveGame() {
        const gameState = {
            btcBalance,
            btcLifetime,
            hardwareEquity,
            btcClickValue,
            lastSaveTime: Date.now(),
            upgrades: upgrades.map(u => ({
                id: u.id,
                level: u.level,
                currentUsd: u.currentUsd,
                currentYield: u.currentYield,
                boostCost: u.boostCost,
                boostLevel: u.boostLevel
            }))
        };
        localStorage.setItem('satoshiTerminalSave', JSON.stringify(gameState));
    }

function loadGame() {
    const savedData = localStorage.getItem('satoshiTerminalSave');
    if (savedData) {
        const state = JSON.parse(savedData);
        btcBalance = state.btcBalance || 0;
        btcLifetime = state.btcLifetime || 0;
        hardwareEquity = state.hardwareEquity || 0;
        btcClickValue = state.btcClickValue || 0.00000250;

        // Load upgrades - handle both old saves (by index) and new saves (by id)
        state.upgrades.forEach((savedU, index) => {
            let upgradeToUpdate;
            if (savedU.id !== undefined) {
                // New format: match by id
                upgradeToUpdate = upgrades.find(u => u.id === savedU.id);
            } else {
                // Old format: match by array index
                upgradeToUpdate = upgrades[index];
            }
            if (upgradeToUpdate) {
                upgradeToUpdate.level = savedU.level || 0;
                upgradeToUpdate.currentUsd = savedU.currentUsd || upgradeToUpdate.baseUsd;
                upgradeToUpdate.currentYield = savedU.currentYield || 0;
                upgradeToUpdate.boostCost = savedU.boostCost || upgradeToUpdate.baseUsd * 0.5;
                upgradeToUpdate.boostLevel = savedU.boostLevel || 0;
            }
        });

        // Recalculate totals
        btcPerSec = upgrades.reduce((sum, item) => sum + (item.currentYield || 0), 0);
        updateUI();

        // Debug log
        console.log('Loaded save:', { btcBalance, hardwareEquity, upgradeLevels: upgrades.map(u => `${u.name}: ${u.level}`) });
    }
}
    // --- SAVE SYSTEM END ---

    function resetGame() {
        if (confirm('Are you sure you want to reset your entire save? This cannot be undone!')) {
            localStorage.removeItem('satoshiTerminalSave');
            // Reset all variables to defaults
            btcBalance = 0;
            btcLifetime = 0;
            btcPerSec = 0;
            btcClickValue = 0.00000250;
            hardwareEquity = 0;
            // Reset all upgrades
            upgrades.forEach(u => {
                u.level = 0;
                u.currentUsd = u.baseUsd;
                u.currentYield = 0;
            });
            updateUI();
            alert('Game reset! Starting fresh.');
        }
    }

    function initShop() {
        const container = document.getElementById('shop');
        container.innerHTML = ''; 
        upgrades.forEach((u, i) => {
            const btn = document.createElement('button');
            btn.className = 'u-item';
            btn.id = `up-${u.id}`;
if (u.isClickUpgrade) {
            btn.classList.add('click-upgrade');
        }

        // For manual hash upgrade, clicking upgrades AND applies boost
        if (u.isClickUpgrade) {
            btn.onclick = () => {
                buyLevel(i);
                buyBoost(i);
            };
        } else {
            btn.onclick = () => buyLevel(i);
        }

        btn.innerHTML = `
            <div style="text-align:left">
                <span style="font-weight:800;font-size:1.3rem;display:block"><span id="lvl-txt-${u.id}" style="color:var(--btc)">[Lvl 0]</span> ${u.name}</span>
                <span style="font-size:1.2rem;color:var(--green);font-family:monospace" id="yield-${u.id}">+0 ₿/s</span>
            </div>
            <div style="text-align:right">
                <span style="font-size:1.16rem;font-weight:900;display:block" id="usd-${u.id}">$${u.baseUsd.toLocaleString()}</span>
                <span style="font-size:1.2rem;color:#666;font-family:monospace" id="btc-cost-${u.id}">₿ 0.00</span>
            </div>`;
        container.appendChild(btn);

        // Add boost button only for non-manual upgrades
        if (!u.isClickUpgrade) {
            const boostBtn = document.createElement('button');
            boostBtn.id = `boost-${u.id}`;
            boostBtn.style.background = '#ff9500';
            boostBtn.style.border = 'none';
            boostBtn.style.borderRadius = '6px';
            boostBtn.style.padding = '6px 10px';
            boostBtn.style.fontSize = '0.7rem';
            boostBtn.style.fontWeight = '700';
            boostBtn.style.color = '#000';
            boostBtn.style.cursor = 'pointer';
            boostBtn.style.marginTop = '2px';
            boostBtn.style.width = '100%';
            boostBtn.style.transition = '0.1s';
            boostBtn.onclick = () => buyBoost(i);
            boostBtn.innerHTML = `+10% HASH RATE | <span id="boost-cost-${u.id}">$0</span>`;
            container.appendChild(boostBtn);
        }
        });
    }

function manualHash() {
    // This adds your current click power to your spendable balance
    btcBalance += btcClickValue;

    // This ensures every manual click also increases your Lifetime Total
    btcLifetime += btcClickValue;

    // Play click sound
    playClickSound();

    // This refreshes the screen so you see the numbers go up
    updateUI();
}

function buyLevel(i) {
    const u = upgrades[i];
    const costBtc = u.currentUsd / btcPrice;
    
    if (btcBalance >= costBtc) {
        btcBalance -= costBtc;
        hardwareEquity += u.currentUsd;
        u.level++;

        // Check if this is the Manual Hash upgrade
        if (u.id === 0 || u.isClickUpgrade) {
            // Increase click value by 10%
            btcClickValue *= 1.10;

            // FASTER PRICE SCALE: % increase per level
            u.currentUsd = Math.floor(u.baseUsd * Math.pow(1.75, u.level));

            // Update the main orange button text to show new click value
            document.querySelector('.mine-btn span').innerText = `+${btcClickValue.toFixed(8)} ₿`;
        } else {
            // ALL OTHER MINERS: Standard 15% increase
            u.currentYield = u.baseYield * u.level * Math.pow(1.10, u.boostLevel);
            u.currentUsd = Math.floor(u.baseUsd * Math.pow(1.15, u.level));
        }

        btcPerSec = upgrades.reduce((sum, item) => sum + (item.currentYield || 0), 0);
        updateUI();
        saveGame();

        // Play upgrade sound
        playUpgradeSound();
    }
}

function buyBoost(i) {
    const u = upgrades[i];
    const costBtc = u.boostCost / btcPrice;

    if (btcBalance >= costBtc) {
        btcBalance -= costBtc;
        hardwareEquity += u.boostCost;
        u.boostLevel++;

        // Increase yield by 10% permanently
        u.currentYield *= 1.10;

        // Double the boost cost for next purchase
        u.boostCost *= 2;

        btcPerSec = upgrades.reduce((sum, item) => sum + (item.currentYield || 0), 0);
        updateUI();
        saveGame();

        // Play upgrade sound
        playUpgradeSound();
    }
}

    function updateUI() {
        let netWorth = (btcBalance * btcPrice); 
        document.getElementById('nw-val').innerText = "$" + netWorth.toLocaleString(undefined, {minimumFractionDigits: 2});
        document.getElementById('bal-btc').innerText = btcBalance.toFixed(8);
        document.getElementById('lifetime-btc').innerText = btcLifetime.toFixed(8);
        document.getElementById('asset-usd').innerText = "$" + Math.floor(hardwareEquity).toLocaleString();
        document.getElementById('yield-btc').innerText = btcPerSec.toFixed(8) + "/s";
document.getElementById('lifetime-btc').innerText = btcLifetime.toFixed(8);

 upgrades.forEach(u => {
    const costBtc = u.currentUsd / btcPrice;
    const yEl = document.getElementById(`yield-${u.id}`);

    if (yEl) {
        if (u.isClickUpgrade) {
            yEl.innerText = `+10% MANUAL HASH RATE`;
        } else {
            // Show the current speed
            const currentSpeed = u.baseYield * u.level * Math.pow(1.10, u.boostLevel);
            yEl.innerText = `+${currentSpeed.toFixed(8)} ₿/s - Current Speed`;
        }
    }

    const uEl = document.getElementById(`usd-${u.id}`);
    if(uEl) uEl.innerText = `$${u.currentUsd.toLocaleString()}`;
    const cEl = document.getElementById(`btc-cost-${u.id}`);
    if(cEl) cEl.innerText = "₿ " + costBtc.toFixed(8);
    const bEl = document.getElementById(`up-${u.id}`);
    if(bEl) bEl.disabled = (btcBalance < costBtc);
    const lEl = document.getElementById(`lvl-txt-${u.id}`);
    if(lEl) lEl.innerText = `[Lvl ${u.level}]`;

    // Update boost button
    const boostCostBtc = u.boostCost / btcPrice;
    const boostCostEl = document.getElementById(`boost-cost-${u.id}`);
    if(boostCostEl) boostCostEl.innerText = `$${Math.floor(u.boostCost).toLocaleString()}`;

    // Format the current yield amount (after all boosts applied)
    const currentYield = u.baseYield * u.level * Math.pow(1.10, u.boostLevel);
    const boostAmtEl = document.getElementById(`boost-amt-${u.id}`);
    if(boostAmtEl) {
        if (currentYield >= 1) {
            boostAmtEl.innerText = currentYield.toFixed(2);
        } else if (currentYield >= 0.0001) {
            boostAmtEl.innerText = (currentYield * 1000000).toFixed(0) + 'μ';
        } else if (currentYield > 0) {
            boostAmtEl.innerText = (currentYield * 1000000000).toFixed(0);
        } else {
            boostAmtEl.innerText = '0';
        }
    }

    const boostBtn = document.getElementById(`boost-${u.id}`);
    if(boostBtn) boostBtn.disabled = (btcBalance < boostCostBtc);
});
    }

    setInterval(() => { 
        const now = Date.now();
        const deltaTime = (now - lastTickTime) / 1000; 
        lastTickTime = now;
        if (btcPerSec > 0) { 
            let gain = btcPerSec * deltaTime;
            btcBalance += gain; 
            btcLifetime += gain; 
            updateUI(); 
        } 
    }, 100);

    setInterval(() => {
        let move = (Math.random() > 0.97) ? ((Math.random() > 0.5 ? 0.25 : -0.25) * Math.random()) : (Math.random() * 0.01 - 0.005);
        btcPrice = Math.max(MIN_PRICE, Math.min(MAX_PRICE, btcPrice * (1 + move)));
        updateUI();
    }, 4000);

    const ctx = document.getElementById('nwChart').getContext('2d');
    const nwChart = new Chart(ctx, {
        type: 'line',
        data: { labels: Array(60).fill(''), datasets: [{ data: Array(60).fill(0), borderColor: '#00ff88', borderWidth: 4, pointRadius: 0, fill: true, backgroundColor: 'rgba(0, 255, 136, 0.1)', tension: 0.3 }] },
        options: { responsive: true, maintainAspectRatio: false, scales: { x: { display: false }, y: { display: true } }, plugins: { legend: { display: false } } }
    });

    setInterval(() => {
        nwChart.data.datasets[0].data.push(btcBalance * btcPrice);
        nwChart.data.datasets[0].data.shift();
        nwChart.update('none');
    }, 2000);

    // Auto-save every 1.5 seconds
    setInterval(saveGame, 1500);

    // Fetch BTC price on startup and every hour
    fetchBTCPrice();
    setInterval(fetchBTCPrice, 3600000); // 3600000ms = 1 hour

    initShop();
    loadGame(); // Load data on startup
    updateUI();
</script>

</body>

</html>




