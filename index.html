<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Satoshi Terminal | Massive Precision</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --btc: #f7931a; --bg: #050505; --panel: #111; --green: #00ff88; --red: #ff3344; --border: #222; }
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); color: #fff; margin: 0; padding: 20px; overflow: hidden; height: 100vh; box-sizing: border-box; }
        
        #main-layout { display: grid; grid-template-columns: 7fr 3fr; gap: 20px; height: calc(100vh - 40px); }
        .panel { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; display: flex; flex-direction: column; padding: 24px; position: relative; overflow: hidden; }
        
        .nw-label { font-size: 1.2rem; color: #555; text-transform: uppercase; letter-spacing: 3px; font-weight: 700; }
        .nw-amount { 
            font-size: 4.5rem; 
            font-weight: 950; 
            color: var(--green); 
            font-family: monospace; 
            line-height: 1; 
            margin: 8px 0; 
            letter-spacing: -3px; 
            white-space: nowrap;
        }
        .btc-stat { font-size: 2.2rem; color: var(--btc); font-weight: bold; font-family: monospace; border-bottom: 2px solid var(--border); padding-bottom: 12px; margin-bottom: 25px; }

        /* Restoring the 2-column feel for the first two, but allowing the 3rd to be wide */
        .mini-stats { display: flex; justify-content: space-between; gap: 30px; margin-bottom: 15px; }
        .stat-item { flex: 1; }
        .stat-item:last-child { flex: 1.5; } /* Give more room to the long BTC string */
        
        .stat-item span { font-size: 0.9rem; color: #777; text-transform: uppercase; display: block; margin-bottom: 5px; font-weight: 800; }
        
        .stat-val { 
            font-size: 2.8rem !important; /* BACK TO BIG FONT */
            color: #ffffff; 
            font-family: monospace; 
            display: flex; 
            align-items: center; 
            line-height: 1;
            font-weight: 900;
            letter-spacing: -2px;
            white-space: nowrap;
        }

        .chart-container { 
            flex: 1; 
            min-height: 0; 
            background: rgba(0,0,0,0.3); 
            border-radius: 8px; 
            border: 1px solid #1a1a1a; 
            position: relative;
            margin-top: 10px;
            padding: 10px;
        }

        .mine-btn { background: var(--btc); color: #000; border: none; width: 100%; padding: 20px; font-weight: 900; border-radius: 10px; cursor: pointer; transition: 0.1s; font-size: 1rem; margin-bottom: 15px; }
        .upgrade-list { flex: 1; overflow-y: auto; padding-right: 5px; }
        .u-item { background: #181818; border: 1px solid #252525; border-radius: 10px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; width: 100%; color: #fff; }
        .u-item:disabled { opacity: 0.2; cursor: not-allowed; }
        
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #333; }
    </style>
</head>
<body>

    <div id="main-layout">
        <div class="panel">
            <span class="nw-label">Portfolio Valuation</span>
            <div class="nw-amount" id="nw-val">$0.00</div>
            <div class="btc-stat">₿ <span id="bal-btc">0.00000000</span></div>

            <div class="mini-stats">
                <div class="stat-item">
                    <span>Hardware Equity</span>
                    <b class="stat-val" id="asset-usd">$0</b>
                </div>
                <div class="stat-item">
                    <span>Hashrate</span>
                    <b class="stat-val" id="yield-btc">0.00/s</b>
                </div>
                <div class="stat-item">
                    <span>Lifetime Mined</span>
                    <b class="stat-val" style="font-size: 48px;">₿<span id="lifetime-btc">0.00013000</span>
</b>

                </div>
            </div>

            <div class="chart-container">
                <canvas id="nwChart"></canvas>
            </div>
        </div>

        <div class="panel">
            <button class="mine-btn" onclick="manualHash()">MANUAL HASH<br>
                <span style="font-size: 1.25rem; font-weight: normal; opacity: 0.7;">+0.00000250 ₿</span>
            </button>
            <div class="upgrade-list" id="shop"></div>
        </div>
    </div>

    <script>
        let btcPrice = 96450;
        let btcBalance = 0;
        let btcLifetime = 0; 
        let btcPerSec = 0;
        let hardwareEquity = 0; 
        const MIN_PRICE = 50000;
        const MAX_PRICE = 200000;

        const upgrades = [
            { id: 1, name: "USB Miner", baseUsd: 25, baseYield: 0.0000001 },
            { id: 2, name: "GTX 1660 Super", baseUsd: 125, baseYield: 0.0000007 },
            { id: 3, name: "RTX 5090 Rig", baseUsd: 3000, baseYield: 0.000015 },
            { id: 4, name: "ASIC Mining Unit", baseUsd: 7500, baseYield: 0.000085 },
            { id: 5, name: "Liquid ASIC Rig", baseUsd: 28000, baseYield: 0.00045 },
            { id: 6, name: "Mobile Mining Container", baseUsd: 110000, baseYield: 0.0032 },
            { id: 7, name: "Geothermal Mining Farm", baseUsd: 680000, baseYield: 0.045 },
            { id: 8, name: "Data Center Facility", baseUsd: 5200000, baseYield: 0.62 },
            { id: 9, name: "Orbital Data Relay", baseUsd: 35000000, baseYield: 5.8 },
            { id: 10, name: "Quantum Computer", baseUsd: 500000000, baseYield: 125.0 }
        ].map(u => ({ ...u, level: 0, currentUsd: u.baseUsd, currentYield: 0 }));

        function initShop() {
            const container = document.getElementById('shop');
            container.innerHTML = ''; 
            upgrades.forEach((u, i) => {
                const btn = document.createElement('button');
                btn.className = 'u-item';
                btn.id = `up-${u.id}`;
                btn.onclick = () => buyLevel(i);
                btn.innerHTML = `
                    <div style="text-align:left">
                        <span style="font-weight:800;font-size:1.3rem;display:block"><span id="lvl-txt-${u.id}" style="color:var(--btc)">[Lvl 0]</span> ${u.name}</span>
                        <span style="font-size:1.2rem;color:var(--green);font-family:monospace" id="yield-${u.id}">+0 ₿/s</span>
                    </div>
                    <div style="text-align:right">
                        <span style="font-size:1.16rem;font-weight:900;display:block" id="usd-${u.id}">$${u.baseUsd.toLocaleString()}</span>
                        <span style="font-size:1.2rem;color:#666;font-family:monospace" id="btc-cost-${u.id}">₿ 0.00</span>
                    </div>`;
                container.appendChild(btn);
            });
        }

        function manualHash() { 
            btcBalance += 0.00000250; 
            btcLifetime += 0.00000250; 
            updateUI(); 
        }

        function buyLevel(i) {
            const u = upgrades[i];
            const costBtc = u.currentUsd / btcPrice;
            if (btcBalance >= costBtc) {
                btcBalance -= costBtc;
                hardwareEquity += u.currentUsd;
                u.level++;
                document.getElementById(`lvl-txt-${u.id}`).innerText = `[Lvl ${u.level}]`;
                u.currentUsd = Math.floor(u.baseUsd * Math.pow(1.15, u.level));
                u.currentYield = u.baseYield * Math.pow(1.1, u.level - 1);
                btcPerSec = upgrades.reduce((sum, item) => sum + (item.level > 0 ? item.currentYield : 0), 0);
                updateUI();
            }
        }

function buyLevel(i) {
    const u = upgrades[i];
    const costBtc = u.currentUsd / btcPrice;
    
    if (btcBalance >= costBtc) {
        // 1. Subtract the cost from the balance
        btcBalance -= costBtc;
        
        // 2. Add to hardware equity
        hardwareEquity += u.currentUsd;
        
        // 3. Update level and costs
        u.level++;
        document.getElementById(`lvl-txt-${u.id}`).innerText = `[Lvl ${u.level}]`;
        
        // Calculate new cost and new yield
        u.currentUsd = Math.floor(u.baseUsd * Math.pow(1.15, u.level));
        u.currentYield = u.baseYield * Math.pow(1.1, u.level - 1);
        
        // 4. Recalculate total hashrate
        btcPerSec = upgrades.reduce((sum, item) => sum + (item.level > 0 ? item.currentYield : 0), 0);
        
        updateUI();
    }
}

function updateUI() {
    let currentBtcValue = btcBalance * btcPrice;
    let netWorth = btcBalance * btcPrice;

    // Portfolio display
    document.getElementById('nw-val').innerText = "$" + netWorth.toLocaleString(undefined, {minimumFractionDigits: 2});
    document.getElementById('bal-btc').innerText = btcBalance.toFixed(8);
    document.getElementById('lifetime-btc').innerText = btcLifetime.toFixed(8);
    document.getElementById('asset-usd').innerText = "$" + Math.floor(hardwareEquity).toLocaleString();

    // FIXED: Changed to 8 decimals so you can see the small yields move!
    document.getElementById('yield-btc').innerText = btcPerSec.toFixed(8) + "/s";

    // Update shop buttons
    upgrades.forEach(u => {
        const costBtc = u.currentUsd / btcPrice;
        const yieldEl = document.getElementById(`yield-${u.id}`);
        if (yieldEl) yieldEl.innerText = `+${(u.level > 0 ? u.currentYield : 0).toFixed(8)} ₿/s`;
        
        const usdEl = document.getElementById(`usd-${u.id}`);
        if (usdEl) usdEl.innerText = `$${u.currentUsd.toLocaleString()}`;
        
        const btcCostEl = document.getElementById(`btc-cost-${u.id}`);
        if (btcCostEl) btcCostEl.innerText = "₿ " + costBtc.toFixed(8);
        
        const btn = document.getElementById(`up-${u.id}`);
        if (btn) btn.disabled = (btcBalance < costBtc);
    });
}

        setInterval(() => {
            let move = (Math.random() > 0.97) ? ((Math.random() > 0.5 ? 0.25 : -0.25) * Math.random()) : (Math.random() * 0.01 - 0.005);
            btcPrice = Math.max(MIN_PRICE, Math.min(MAX_PRICE, btcPrice * (1 + move)));
            updateUI();
        }, 4000);

        setInterval(() => { 
            if (btcPerSec > 0) { 
                let gain = (btcPerSec / 10);
                btcBalance += gain; 
                btcLifetime += gain; 
                updateUI(); 
            } 
        }, 100);

        const ctx = document.getElementById('nwChart').getContext('2d');
        const nwChart = new Chart(ctx, {
            type: 'line',
            data: { labels: Array(60).fill(''), datasets: [{ data: Array(60).fill(0), borderColor: '#00ff88', borderWidth: 4, pointRadius: 0, fill: true, backgroundColor: 'rgba(0, 255, 136, 0.1)', tension: 0.3 }] },
            options: { 
                responsive: true, 
                maintainAspectRatio: false, 
                scales: { 
                    x: { display: false }, 
                    y: { 
                        display: true,
                        position: 'left',
                        grid: { color: '#1a1a1a' },
                        ticks: {
                            color: '#555',
                            font: { family: 'monospace', size: 10 },
                            callback: function(value) { return '$' + value.toLocaleString(); }
                        }
                    } 
                }, 
                plugins: { legend: { display: false } } 
            }
        });

        setInterval(() => {
            nwChart.data.datasets[0].data.push((btcBalance * btcPrice) + hardwareEquity);
            nwChart.data.datasets[0].data.shift();
            nwChart.update('none');
        }, 2000);

        initShop();
        updateUI();
    </script>
</body>
</html>