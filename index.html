<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Anti-debugging protection -->
    <!-- <script>
      setInterval(function() {
        debugger;
      }, 100);
    </script> -->

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2H559N5J64"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2H559N5J64');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idle BTC Miner - Play Free Crypto Idle Game | Bitcoin, Ethereum & Dogecoin Mining</title>
    <meta name="description" content="Start mining virtual Bitcoin, Ethereum, and Dogecoin today! Play Idle BTC Miner - our free idle crypto mining game. Earn virtual cryptocurrency through manual hashing, automated miners, and strategic upgrades. No real money involved - pure entertainment.">
    <meta name="keywords" content="idle BTC miner, idle game, bitcoin game, crypto game, ethereum mining, dogecoin mining, idle mining game, cryptocurrency game, free crypto game, bitcoin idle game, ethereum idle game, money game, clicker game, incremental game">
    <meta name="author" content="Aaron Khan">
    <meta name="theme-color" content="#f7931a">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.idlebtcminer.com">
    <meta property="og:title" content="Idle BTC Miner - Free Crypto Mining Game">
    <meta property="og:description" content="Start mining virtual Bitcoin, Ethereum, and Dogecoin today! Play Idle BTC Miner - our free idle crypto mining game with automated miners and strategic upgrades.">
    <meta property="og:image" content="https://www.idlebtcminer.com/og-image.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://www.idlebtcminer.com">
    <meta property="twitter:title" content="Idle BTC Miner - Free Crypto Mining Game">
    <meta property="twitter:description" content="Start mining virtual Bitcoin, Ethereum, and Dogecoin today! Play Idle BTC Miner - our free idle crypto mining game.">
    <meta property="twitter:image" content="https://www.idlebtcminer.com/og-image.png">

    <!-- Additional SEO -->
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <link rel="canonical" href="https://www.idlebtcminer.com">
    <link rel="sitemap" type="application/xml" href="https://www.idlebtcminer.com/sitemap.xml">

    <!-- Cache buster - forces fresh load on updates -->
    <script>
        // Debug viewport and media query detection
        function logViewportInfo() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            const devicePixelRatio = window.devicePixelRatio || 1;
            const isPortrait = width < height;
            const isMobileResolution = width <= 768 || isPortrait;

            console.log('üì± VIEWPORT INFO:');
            console.log('  Window Width: ' + width + 'px');
            console.log('  Window Height: ' + height + 'px');
            console.log('  Device Pixel Ratio: ' + devicePixelRatio);
            console.log('  Orientation: ' + (isPortrait ? 'Portrait' : 'Landscape'));
            console.log('  Is Mobile (portrait OR <=768px): ' + isMobileResolution);
            console.log('  Should stack to single column: ' + isMobileResolution);
        }

        // Log on load
        window.addEventListener('DOMContentLoaded', logViewportInfo);
        window.addEventListener('resize', logViewportInfo);

        // Check immediately
        logViewportInfo();

        // Check if app has been updated
        const appVersion = '1.0.3'; // Increment this version to force cache clear

        try {
            const storedVersion = localStorage.getItem('appVersion');

            if (storedVersion !== appVersion) {
                console.log('üîÑ App updated! Clearing old cache...');

                // Clear all app-related caches
                localStorage.removeItem('satoshiTerminalSave');
                localStorage.removeItem('instructionsDismissed');

                // Clear service worker cache if it exists
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.getRegistrations().then(registrations => {
                        registrations.forEach(reg => reg.unregister());
                    });
                }

                // Store new version BEFORE reload to prevent infinite loop
                localStorage.setItem('appVersion', appVersion);

                console.log('‚úÖ Cache cleared! Forcing hard reload...');

                // Force a hard reload to clear browser cache
                // This bypasses the HTTP cache and forces fresh JS/CSS files
                setTimeout(() => {
                    window.location.reload(true); // Hard reload
                }, 100);
            }
        } catch (e) {
            // localStorage not available (incognito mode, etc.)
            console.warn('‚ö†Ô∏è localStorage not available (incognito mode?). Continuing without local cache...');
        }
    </script>

    <!-- Safe Storage Wrapper for Incognito/Private Mode Support -->
    <script>
        // Create a safe storage object that works in incognito mode
        window.safeStorage = {
            _storage: {},
            _isAvailable: false,

            init: function() {
                try {
                    localStorage.setItem('_test_', 'test');
                    localStorage.removeItem('_test_');
                    this._isAvailable = true;
                    console.log('‚úÖ localStorage is available');
                } catch (e) {
                    this._isAvailable = false;
                    console.warn('‚ö†Ô∏è localStorage unavailable - using memory storage instead');
                }
            },

            setItem: function(key, value) {
                try {
                    if (this._isAvailable) {
                        localStorage.setItem(key, value);
                        console.log('‚úì Saved to localStorage:', key);
                    } else {
                        this._storage[key] = value;
                        console.log('‚úì Saved to memory storage:', key);
                    }
                } catch (e) {
                    this._storage[key] = value;
                    console.log('‚úì Saved to memory storage (fallback):', key);
                }
            },

            getItem: function(key) {
                try {
                    if (this._isAvailable) {
                        const value = localStorage.getItem(key);
                        console.log('‚úì Retrieved from localStorage:', key, '=', value ? 'EXISTS' : 'NULL');
                        return value;
                    } else {
                        const value = this._storage[key] || null;
                        console.log('‚úì Retrieved from memory storage:', key, '=', value ? 'EXISTS' : 'NULL');
                        return value;
                    }
                } catch (e) {
                    const value = this._storage[key] || null;
                    console.log('‚úì Retrieved from memory storage (fallback):', key, '=', value ? 'EXISTS' : 'NULL');
                    return value;
                }
            },

            removeItem: function(key) {
                try {
                    if (this._isAvailable) {
                        localStorage.removeItem(key);
                        console.log('‚úì Removed from localStorage:', key);
                    } else {
                        delete this._storage[key];
                        console.log('‚úì Removed from memory storage:', key);
                    }
                } catch (e) {
                    delete this._storage[key];
                    console.log('‚úì Removed from memory storage (fallback):', key);
                }
            }
        };

        // Initialize safe storage immediately
        window.safeStorage.init();
        console.log('üîß safeStorage initialized - _isAvailable:', window.safeStorage._isAvailable);
    </script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles.css?v=20260123042921">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Firebase Configuration, Save/Load, and Authentication -->
    <script src="firebase-config.js?v=20260123040255"></script>
    <script src="firebase-save.js?v=20260123040920"></script>
    <script src="firebase-auth.js?v=20260123044550"></script>
</head>
<body>

    <!-- Login Screen (Firebase) -->
    <div id="login-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(3px); -webkit-backdrop-filter: blur(3px); z-index: 100000; overflow: auto;">
        <iframe src="login-screen.html?v=20260123044550" style="width: 100%; height: 100%; border: none;"></iframe>
    </div>

    <!-- Consolidated Onboarding Modal (Age + Terms) -->
    <div id="onboarding-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10000; justify-content: center; align-items: center; overflow: auto;">
        <div style="background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); padding: 40px; border-radius: 12px; max-width: 650px; max-height: 90vh; overflow-y: auto; text-align: center; border: 2px solid #f7931a; box-shadow: 0 0 30px rgba(247,147,26,0.5); margin: 20px;">
            <h2 style="color: #f7931a; margin-bottom: 10px; font-size: 2rem;">‚ö†Ô∏è Welcome to Idle BTC Miner</h2>
            <p style="color: #888; font-size: 0.85rem; margin-bottom: 25px;">Please review the following before continuing</p>

            <!-- Age Requirement Section -->
            <div style="background: rgba(247,147,26,0.1); border: 1px solid #f7931a; border-radius: 8px; padding: 20px; margin-bottom: 25px; text-align: left;">
                <h3 style="color: #f7931a; margin: 0 0 10px 0; font-size: 1.2rem;">18+ Age Requirement</h3>
                <p style="color: #fff; font-size: 1rem; margin: 0 0 10px 0; line-height: 1.5;">
                    This game is intended for users <strong>18 years or older</strong>.
                </p>
                <p style="color: #aaa; font-size: 0.9rem; margin: 0; line-height: 1.4;">
                    This is a <strong>simulation game</strong> with <strong>no real cryptocurrency or monetary value</strong>. All currency and assets are virtual and for entertainment purposes only.
                </p>
            </div>

            <!-- Terms & Conditions Section -->
            <div style="background: rgba(255,255,255,0.05); border: 1px solid #f7931a; border-radius: 8px; padding: 20px; margin-bottom: 25px; text-align: left;">
                <h3 style="color: #f7931a; margin: 0 0 10px 0; font-size: 1.2rem;">üìã Terms & Conditions</h3>
                <p style="color: #aaa; font-size: 0.85rem; margin: 0 0 12px 0;">
                    By continuing, you agree to our Terms & Conditions. <a href="#" onclick="openPrivacyModal(); switchPolicyTab('terms'); return false;" style="color: #f7931a; text-decoration: underline;">Read full terms</a>
                </p>
                <div style="background: rgba(0,0,0,0.3); border: 1px solid #333; border-radius: 6px; padding: 12px; max-height: 180px; overflow-y: auto; text-align: left;">
                    <iframe id="terms-preview" src="terms.html?v=20260123040255" style="width: 100%; height: 160px; border: none; background: transparent;"></iframe>
                </div>
            </div>

            <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                <button onclick="acceptOnboarding()" style="background: #f7931a; color: #000; border: none; padding: 12px 35px; font-weight: 800; border-radius: 8px; cursor: pointer; font-size: 1rem; transition: 0.2s; box-shadow: 0 4px 15px rgba(247,147,26,0.4);">
                    ‚úì I ACCEPT & CONTINUE
                </button>
                <button onclick="declineOnboarding()" style="background: #333; color: #f7931a; border: 2px solid #f7931a; padding: 12px 35px; font-weight: 800; border-radius: 8px; cursor: pointer; font-size: 1rem; transition: 0.2s;">
                    ‚úó DECLINE
                </button>
            </div>
        </div>
    </div>

    <!-- Leaderboard Modal -->
    <div id="leaderboard-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10001; justify-content: center; align-items: center; overflow: auto;">
        <div style="background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); padding: 40px; border-radius: 12px; max-width: 700px; width: 90%; max-height: 90vh; border: 2px solid #f7931a; box-shadow: 0 0 30px rgba(247,147,26,0.5); position: relative;">
            <button onclick="closeLeaderboardModal()" style="position: absolute; top: 15px; right: 15px; background: #f7931a; color: #000; border: none; padding: 10px 20px; font-weight: 800; border-radius: 6px; cursor: pointer; font-size: 1rem; transition: 0.2s; z-index: 1;">
                CLOSE
            </button>
            <h2 style="color: #f7931a; margin-bottom: 10px; font-size: 2rem; text-align: center;">üèÜ LEADERBOARD</h2>
            <div id="leaderboard-refresh-info" style="text-align: center; color: #888; font-size: 0.75rem; margin-bottom: 15px; font-family: monospace;">
                Updates on login/logout or when returning after 6+ hours away
            </div>
            <div class="leaderboard-content" style="color: #fff;">
                <div style="text-align: center; color: #888;">Loading leaderboard...</div>
            </div>
        </div>
    </div>

    <!-- Privacy & Cookie Policy Modal -->
    <div id="privacy-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1000000; justify-content: center; align-items: center; overflow: auto;">
        <div style="background: #fff; padding: 20px; border-radius: 12px; max-width: 900px; width: 90%; max-height: 90vh; overflow-y: auto; margin: 20px; position: relative; border: 2px solid #f7931a; box-shadow: 0 0 30px rgba(247,147,26,0.5);">
            <button onclick="closePrivacyModal()" style="position: absolute; top: 15px; right: 15px; background: #f7931a; color: #000; border: none; padding: 10px 20px; font-weight: 800; border-radius: 6px; cursor: pointer; font-size: 1rem; transition: 0.2s; z-index: 1;">
                CLOSE
            </button>
            <!-- Policy Tabs -->
            <div style="display: flex; gap: 10px; margin-bottom: 15px; border-bottom: 2px solid #f7931a;">
                <button id="policy-tab-privacy" onclick="switchPolicyTab('privacy')" style="padding: 10px 20px; background: #f7931a; color: #000; border: none; font-weight: 800; cursor: pointer; border-radius: 6px 6px 0 0; font-size: 0.95rem;">
                    PRIVACY POLICY
                </button>
                <button id="policy-tab-cookies" onclick="switchPolicyTab('cookies')" style="padding: 10px 20px; background: #ddd; color: #000; border: none; font-weight: 800; cursor: pointer; border-radius: 6px 6px 0 0; font-size: 0.95rem;">
                    COOKIE POLICY
                </button>
                <button id="policy-tab-terms" onclick="switchPolicyTab('terms')" style="padding: 10px 20px; background: #ddd; color: #000; border: none; font-weight: 800; cursor: pointer; border-radius: 6px 6px 0 0; font-size: 0.95rem;">
                    TERMS & CONDITIONS
                </button>
                <button id="policy-tab-contact" onclick="switchPolicyTab('contact')" style="padding: 10px 20px; background: #ddd; color: #000; border: none; font-weight: 800; cursor: pointer; border-radius: 6px 6px 0 0; font-size: 0.95rem;">
                    CONTACT
                </button>
            </div>
            <iframe id="privacy-iframe" src="privacy.html?v=20260123040255" style="width: 100%; height: 80vh; border: none;"></iframe>
        </div>
    </div>

    <div id="main-layout">
        <div class="panel">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; flex-wrap: wrap; gap: 8px;">
                <span class="nw-label" style="color: #555 !important; text-transform: uppercase !important; letter-spacing: 3px !important; font-weight: 700 !important;">Crypto Portfolio Valuation</span>
                <div style="display: flex; gap: 6px; align-items: center; flex-wrap: wrap;">
                    <button id="login-btn" style="background: #f7931a; color: #000; border: none; padding: 4px 8px; font-weight: 700; border-radius: 4px; cursor: pointer; font-size: 0.55rem; white-space: nowrap;" onclick="showLoginScreen()">LOGIN / SIGN UP</button>
                    <button style="background: #FFD700; color: #000; border: none; padding: 4px 8px; font-weight: 700; border-radius: 4px; cursor: pointer; font-size: 0.55rem; white-space: nowrap;" onclick="openLeaderboardModal()">üèÜ LEADERBOARD</button>
                    <button id="mute-btn" style="background: #888; color: white; border: none; padding: 4px 8px; font-weight: 700; border-radius: 4px; cursor: pointer; font-size: 0.55rem; white-space: nowrap;" onclick="toggleMute()">SOUND ON</button>
                    <button style="background: #4CAF50; color: white; border: none; padding: 4px 8px; font-weight: 700; border-radius: 4px; cursor: pointer; font-size: 0.55rem; white-space: nowrap;" onclick="document.getElementById('game-instructions').style.display='block'; window.safeStorage.removeItem('instructionsDismissed');">SHOW HELP</button>
                    <button style="background: #ffa500; color: white; border: none; padding: 4px 8px; font-weight: 700; border-radius: 4px; cursor: pointer; font-size: 0.55rem; white-space: nowrap;" onclick="resetEarningsStats()">RESET EARNINGS</button>
                    <button style="background: #ff3344; color: white; border: none; padding: 4px 8px; font-weight: 700; border-radius: 4px; cursor: pointer; font-size: 0.55rem; white-space: nowrap;" onclick="resetGame()">RESET SAVE</button>
                </div>
            </div>
            <div class="nw-amount" id="nw-val">$0.00</div>

            <!-- Crypto Balances -->
            <div style="display: flex; flex-direction: column; gap: 8px; margin-bottom: 20px;">
                <div style="font-size: 1.4rem; color: #f7931a; font-weight: bold; font-family: monospace;">‚Çø <span id="bal-btc">0.00000000</span></div>
                <div style="font-size: 1.4rem; color: #627eea; font-weight: bold; font-family: monospace;">Œû <span id="bal-eth">0.00000000</span></div>
                <div style="font-size: 1.4rem; color: #c2a633; font-weight: bold; font-family: monospace;">√ê <span id="bal-doge">0.00</span></div>
                <div style="font-size: 1.4rem; color: #00ff88; font-weight: bold; font-family: monospace;">üî∑ <span id="skill-tokens-display">0</span> Skill Tokens</div>
            </div>

            <div class="mini-stats">
                <div class="stat-item">
                    <span>Hardware Equity</span>
                    <b class="stat-val" id="asset-usd">$0</b>
                </div>
            </div>

            <!-- Skill Tree Button -->
            <button onclick="openSkillTreeModal()" style="width: 100%; background: linear-gradient(135deg, #f7931a 0%, #ff6b35 100%); color: #000; border: none; padding: 12px; font-weight: 800; border-radius: 8px; cursor: pointer; font-size: 0.9rem; transition: 0.2s; box-shadow: 0 2px 10px rgba(247,147,26,0.3); margin-bottom: 15px;">
                üåü SKILL TREE
            </button>

            <!-- Game Instructions (Floating Overlay) -->
            <div id="game-instructions" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 16px 24px; background: rgba(255, 193, 7, 0.15); border: 2px solid rgba(255, 193, 7, 0.6); border-radius: 8px; max-width: 600px; text-align: center; z-index: 50000; box-shadow: 0 4px 20px rgba(0,0,0,0.5); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px);">
                <button onclick="dismissInstructions()" style="position: absolute; top: 8px; right: 8px; background: rgba(255, 255, 255, 0.2); border: none; color: #fff; cursor: pointer; font-size: 1.2rem; padding: 4px 10px; border-radius: 4px; font-weight: bold; line-height: 1; transition: 0.2s;">√ó</button>
                <div style="font-size: 0.85rem; color: #fff; line-height: 1.6; padding: 8px 0;">
                    <strong style="color: #f7931a; font-size: 1rem; display: block; margin-bottom: 8px;">üéÆ HOW TO PLAY</strong>
                    Begin by <strong>Manually Hashing BTC, ETH or Doge</strong>. Sell or Stake your Crypto at the Exchange.<br>
                    You will find Miners in the BTC, ETH and DOGE tabs. <strong style="color: #ff3344;">DON'T FORGET ABOUT POWER!</strong>
                </div>
            </div>

            <!-- Hashrate Display -->
            <div id="hashrate-display" style="display: flex; gap: 6px; margin-bottom: 0.1px; justify-content: flex-end; flex-wrap: wrap;">
                <div class="stat-box stat-box-session" style="padding: 9px 15px; background: rgba(0,0,0,0.3); border-radius: 4px; border: 1px solid #222;">
                    <span style="font-size: 0.75rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 3px; font-weight: 800;">TIME THIS SESSION</span>
                    <b style="font-size: 1.1rem; color: #ffffff; font-family: monospace; font-weight: 900; word-break: break-word;" id="session-time">0m 0s</b>
                </div>
                <div class="stat-box stat-box-session-earnings" style="padding: 9px 15px; background: rgba(0,0,0,0.3); border-radius: 4px; border: 1px solid #222;">
                    <span style="font-size: 0.75rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 3px; font-weight: 800;">EARNING THIS SESSION</span>
                    <b style="font-size: 1.1rem; color: #00ff88; font-family: monospace; font-weight: 900; word-break: break-word;" id="session-earning">$0.00</b>
                </div>
                <div class="stat-box stat-box-earnings" style="padding: 9px 15px; background: rgba(0,0,0,0.3); border-radius: 4px; border: 1px solid #222;">
                    <span style="font-size: 0.75rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 3px; font-weight: 800;">LIFETIME EARNINGS</span>
                    <b style="font-size: 1.1rem; color: #00ff88; font-family: monospace; font-weight: 900; word-break: break-word;" id="lifetime-earning">$0.00</b>
                </div>
                <div class="stat-box stat-box-btc" style="padding: 9px 15px; background: rgba(0,0,0,0.3); border-radius: 4px; border: 1px solid #222;">
                    <span style="font-size: 0.75rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 3px; font-weight: 800;">BTC HASHRATE</span>
                    <b style="font-size: 1.1rem; color: #f7931a; font-family: monospace; font-weight: 900; white-space: nowrap;" id="yield-btc">0.00000000/s</b>
                </div>
                <div class="stat-box stat-box-eth" style="padding: 9px 15px; background: rgba(0,0,0,0.3); border-radius: 4px; border: 1px solid #222;">
                    <span style="font-size: 0.75rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 3px; font-weight: 800;">ETH HASHRATE</span>
                    <b style="font-size: 1.1rem; color: #627eea; font-family: monospace; font-weight: 900; white-space: nowrap;" id="yield-eth">0.00000000/s</b>
                </div>
                <div class="stat-box stat-box-doge" style="padding: 9px 15px; background: rgba(0,0,0,0.3); border-radius: 4px; border: 1px solid #222;">
                    <span style="font-size: 0.75rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 3px; font-weight: 800;">DOGE HASHRATE</span>
                    <b style="font-size: 1.1rem; color: #c2a633; font-family: monospace; font-weight: 900; white-space: nowrap;" id="yield-doge">0.00000000/s</b>
                </div>
            </div>

            <!-- Crypto Prices -->
            <div style="margin-top: 20px; padding: 12px; background: rgba(0,0,0,0.3); border-radius: 8px; border: 1px solid #222;">
                <span style="font-size: 0.85rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 8px;">Crypto Prices (Virtual)</span>
                <div id="crypto-prices-flex" style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 120px;">
                        <div style="font-size: 0.65rem; color: #f7931a; font-weight: 800;">BITCOIN</div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <b class="stat-val" id="btc-price" style="font-size: 1.4rem;">$100,000</b>
                            <span id="btc-indicator" style="font-size: 1.2rem; font-weight: bold; min-width: 20px;"></span>
                            <span id="btc-change" style="font-size: 0.9rem; font-weight: bold; min-width: 50px;"></span>
                        </div>
                    </div>
                    <div style="flex: 1; min-width: 120px;">
                        <div style="font-size: 0.65rem; color: #627eea; font-weight: 800;">ETHEREUM</div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <b class="stat-val" id="eth-price" style="font-size: 1.4rem;">$3,500</b>
                            <span id="eth-indicator" style="font-size: 1.2rem; font-weight: bold; min-width: 20px;"></span>
                            <span id="eth-change" style="font-size: 0.9rem; font-weight: bold; min-width: 50px;"></span>
                        </div>
                    </div>
                    <div style="flex: 1; min-width: 120px;">
                        <div style="font-size: 0.65rem; color: #c2a633; font-weight: 800;">DOGECOIN</div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <b class="stat-val" id="doge-price" style="font-size: 1.4rem;">$0.25</b>
                            <span id="doge-indicator" style="font-size: 1.2rem; font-weight: bold; min-width: 20px;"></span>
                            <span id="doge-change" style="font-size: 0.9rem; font-weight: bold; min-width: 50px;"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="chart-wrapper" style="position: relative;">
                <canvas id="nwChart"></canvas>
            </div>
        </div>

        <div class="panel" style="display: flex; flex-direction: column; min-height: 0; position: relative; z-index: 50;">
            <button class="mine-btn" onclick="console.log('üî≤ ONCLICK FIRED'); if(typeof manualHash !== 'function') { alert('ERROR: manualHash is not a function!'); console.error('manualHash not found:', typeof manualHash); } else { manualHash(); }" style="position: relative; z-index: 100;">MANUAL BTC HASH<br>
                <span style="font-size: 0.8rem; font-weight: normal; opacity: 0.7;">+0.00000250 ‚Çø</span>
            </button>
            <button class="mine-btn" style="background: #627eea; padding: 8px;" onclick="manualEthHash()">MANUAL ETH HASH<br>
                <span style="font-size: 0.8rem; font-weight: normal; opacity: 0.7;">+0.00007143 Œû</span>
            </button>
            <button class="mine-btn" style="background: #c2a633; padding: 8px;" onclick="manualDogeHash()">MANUAL DOGE HASH<br>
                <span style="font-size: 0.8rem; font-weight: normal; opacity: 0.7;">+1.00000000 √ê</span>
            </button>
            <button id="autoclicker-btn" style="background: #666; color: white; border: none; width: 100%; padding: 8px; font-weight: 700; border-radius: 10px; cursor: pointer; margin-bottom: 8px; font-size: 0.75rem;" onclick="startAutoClicker()">AUTO CLICKER ‚Ä¢ 5 clicks/sec ‚Ä¢ 30s ‚Ä¢ 5m cooldown</button>

            <!-- Power Status Bar -->
            <div style="padding: 8px; background: rgba(0,0,0,0.3); border-radius: 8px; border: 1px solid #222; margin-bottom: 8px;">
                <div style="display: flex; gap: 8px; align-items: center; justify-content: space-between;">
                    <div style="flex: 1;">
                        <span style="font-size: 0.65rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 2px;">Power Status</span>
                        <div style="font-size: 0.65rem; color: #00ff88; font-family: monospace; font-weight: 900;" id="power-used">0W / 0W</div>
                        <div id="power-bar" style="height: 6px; background: #222; border-radius: 3px; margin-top: 2px;">
                            <div id="power-bar-fill" style="height: 100%; background: #00ff88; border-radius: 3px; width: 0%;"></div>
                        </div>
                    </div>
                    <button class="tab-btn" onclick="switchTab('power', event)" title="Upgrade your power supply to support more mining equipment" style="border-color: #00ff88; color: #00ff88; padding: 6px 12px; white-space: nowrap;">UPGRADE POWER SUPPLY</button>
                </div>
            </div>

            <!-- Dollar Balance Display -->
            <div title="Your USD earned from selling crypto. Game saves locally every second. Cloud saves every 10 min for multi-device access." style="padding: 6px; background: rgba(0,255,136,0.1); border-radius: 8px; border: 2px solid #00ff88; margin-bottom: 8px; text-align: center; cursor: help;">
                <span style="font-size: 0.6rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 1px; font-weight: 800;">Cash Balance</span>
                <b style="color: #00ff88; font-family: monospace; font-weight: 900;" id="dollar-balance">$0</b>
            </div>

            <!-- Tab Buttons -->
            <div class="tab-buttons" style="margin-bottom: 6px;">
                <button class="tab-btn active" onclick="switchTab('btc-mining', event)" title="Mine Bitcoin - Click to earn, buy miners & upgrades" style="border-color: #f7931a; color: #f7931a;">BTC</button>
                <button class="tab-btn" onclick="switchTab('eth-mining', event)" title="Mine Ethereum - Click to earn, buy miners & upgrades" style="border-color: #627eea; color: #627eea;">ETH</button>
                <button class="tab-btn" onclick="switchTab('doge-mining', event)" title="Mine Dogecoin - Click to earn, buy miners & upgrades" style="border-color: #c2a633; color: #c2a633;">DOGE</button>
            </div>
            <div class="tab-buttons">
                <button class="tab-btn" onclick="switchTab('market', event)" title="Sell crypto for cash, stake coins to earn passive income" style="border-color: #00ff88; color: #00ff88;">CRYPTO EXCHANGE</button>
            </div>

            <!-- BTC Mining Tab -->
            <div id="btc-mining-tab" class="tab-content active" style="flex-direction: column; min-height: 0; flex: 1;">
                <!-- Buy Quantity Toggle -->
                <div style="margin-bottom: 10px;">
                    <span style="font-size: 0.7rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 5px; font-weight: 800;">Purchase Amount</span>
                    <div style="display: flex; gap: 6px;">
                        <button id="qty-toggle-1" class="qty-toggle active" onclick="setBuyQuantity(1)" style="border-color: #888; color: #888;">1x</button>
                        <button id="qty-toggle-2" class="qty-toggle" onclick="setBuyQuantity(2)" style="border-color: #888; color: #888;">2x</button>
                        <button id="qty-toggle-5" class="qty-toggle" onclick="setBuyQuantity(5)" style="border-color: #888; color: #888;">5x</button>
                        <button id="qty-toggle-10" class="qty-toggle" onclick="setBuyQuantity(10)" style="border-color: #888; color: #888;">10x</button>
                    </div>
                </div>
                <div class="upgrade-list" id="btc-shop" style="flex: 1; min-height: 0; overflow-y: auto;"></div>
            </div>

            <!-- ETH Mining Tab -->
            <div id="eth-mining-tab" class="tab-content" style="flex-direction: column; min-height: 0; flex: 1;">
                <!-- Buy Quantity Toggle -->
                <div style="margin-bottom: 10px;">
                    <span style="font-size: 0.7rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 5px; font-weight: 800;">Purchase Amount</span>
                    <div style="display: flex; gap: 6px;">
                        <button id="eth-qty-toggle-1" class="qty-toggle active" onclick="setBuyQuantity(1)" style="border-color: #888; color: #888;">1x</button>
                        <button id="eth-qty-toggle-2" class="qty-toggle" onclick="setBuyQuantity(2)" style="border-color: #888; color: #888;">2x</button>
                        <button id="eth-qty-toggle-5" class="qty-toggle" onclick="setBuyQuantity(5)" style="border-color: #888; color: #888;">5x</button>
                        <button id="eth-qty-toggle-10" class="qty-toggle" onclick="setBuyQuantity(10)" style="border-color: #888; color: #888;">10x</button>
                    </div>
                </div>
                <div class="upgrade-list" id="eth-shop" style="flex: 1; min-height: 0; overflow-y: auto;"></div>
            </div>

            <!-- DOGE Mining Tab -->
            <div id="doge-mining-tab" class="tab-content" style="flex-direction: column; min-height: 0; flex: 1;">
                <!-- Buy Quantity Toggle -->
                <div style="margin-bottom: 10px;">
                    <span style="font-size: 0.7rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 5px; font-weight: 800;">Purchase Amount</span>
                    <div style="display: flex; gap: 6px;">
                        <button id="doge-qty-toggle-1" class="qty-toggle active" onclick="setBuyQuantity(1)" style="border-color: #888; color: #888;">1x</button>
                        <button id="doge-qty-toggle-2" class="qty-toggle" onclick="setBuyQuantity(2)" style="border-color: #888; color: #888;">2x</button>
                        <button id="doge-qty-toggle-5" class="qty-toggle" onclick="setBuyQuantity(5)" style="border-color: #888; color: #888;">5x</button>
                        <button id="doge-qty-toggle-10" class="qty-toggle" onclick="setBuyQuantity(10)" style="border-color: #888; color: #888;">10x</button>
                    </div>
                </div>
                <div class="upgrade-list" id="doge-shop" style="flex: 1; min-height: 0; overflow-y: auto;"></div>
            </div>

            <!-- Power Tab -->
            <div id="power-tab" class="tab-content" style="flex-direction: column; min-height: 0; flex: 1;">
                <!-- Buy Quantity Toggle -->
                <div style="margin-bottom: 10px;">
                    <span style="font-size: 0.7rem; color: #888; text-transform: uppercase; display: block; margin-bottom: 5px; font-weight: 800;">Purchase Amount</span>
                    <div style="display: flex; gap: 6px;">
                        <button class="qty-toggle active" onclick="setBuyQuantity(1)" style="border-color: #888; color: #888;">1x</button>
                        <button class="qty-toggle" onclick="setBuyQuantity(2)" style="border-color: #888; color: #888;">2x</button>
                        <button class="qty-toggle" onclick="setBuyQuantity(5)" style="border-color: #888; color: #888;">5x</button>
                        <button class="qty-toggle" onclick="setBuyQuantity(10)" style="border-color: #888; color: #888;">10x</button>
                    </div>
                </div>
                <div class="upgrade-list" id="power-shop" style="flex: 1; min-height: 0; overflow-y: auto;"></div>
            </div>

            <!-- Market Tab -->
            <div id="market-tab" class="tab-content" style="flex-direction: column; min-height: 0; flex: 1;">
                <div class="upgrade-list" style="flex: 1; min-height: 0; overflow-y: auto; padding: 10px;">
                    <div style="margin-bottom: 15px;">
                        <h3 style="color: #00ff88; margin: 0 0 10px 0; font-size: 1.2rem;">Sell Crypto for Cash</h3>
                        <p style="color: #888; font-size: 0.75rem; margin: 0;">Convert your mined cryptocurrency to dollars to purchase upgrades</p>
                    </div>

                    <!-- BTC Sell -->
                    <div style="background: rgba(247, 147, 26, 0.1); border: 1px solid #f7931a; border-radius: 8px; padding: 12px; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="color: #f7931a; font-weight: 800; font-size: 1.1rem;">‚Çø Bitcoin</span>
                            <span style="color: #888; font-size: 0.8rem;">$<span id="market-btc-price">100,000</span> each</span>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;">
                            <button onclick="sellBTC(0.001)" style="background: #f7931a; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 0.001</button>
                            <button onclick="sellBTC(0.01)" style="background: #f7931a; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 0.01</button>
                            <button onclick="sellBTC(0.1)" style="background: #f7931a; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 0.1</button>
                            <button onclick="sellBTC(1)" style="background: #f7931a; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 1</button>
                        </div>
                        <button onclick="sellAllBTC()" style="background: #333; color: #f7931a; border: 1px solid #f7931a; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem; width: 100%; margin-top: 6px;">SELL ALL</button>
                    </div>

                    <!-- ETH Sell -->
                    <div style="background: rgba(98, 126, 234, 0.1); border: 1px solid #627eea; border-radius: 8px; padding: 12px; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="color: #627eea; font-weight: 800; font-size: 1.1rem;">Œû Ethereum</span>
                            <span style="color: #888; font-size: 0.8rem;">$<span id="market-eth-price">3,500</span> each</span>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;">
                            <button onclick="sellETH(0.01)" style="background: #627eea; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 0.01</button>
                            <button onclick="sellETH(0.1)" style="background: #627eea; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 0.1</button>
                            <button onclick="sellETH(1)" style="background: #627eea; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 1</button>
                            <button onclick="sellETH(10)" style="background: #627eea; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 10</button>
                        </div>
                        <button onclick="sellAllETH()" style="background: #333; color: #627eea; border: 1px solid #627eea; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem; width: 100%; margin-top: 6px;">SELL ALL</button>
                    </div>

                    <!-- DOGE Sell -->
                    <div style="background: rgba(194, 166, 51, 0.1); border: 1px solid #c2a633; border-radius: 8px; padding: 12px; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="color: #c2a633; font-weight: 800; font-size: 1.1rem;">√ê Dogecoin</span>
                            <span style="color: #888; font-size: 0.8rem;">$<span id="market-doge-price">0.25</span> each</span>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;">
                            <button onclick="sellDOGE(1)" style="background: #c2a633; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 1</button>
                            <button onclick="sellDOGE(10)" style="background: #c2a633; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 10</button>
                            <button onclick="sellDOGE(100)" style="background: #c2a633; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 100</button>
                            <button onclick="sellDOGE(1000)" style="background: #c2a633; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">SELL 1000</button>
                        </div>
                        <button onclick="sellAllDOGE()" style="background: #333; color: #c2a633; border: 1px solid #c2a633; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem; width: 100%; margin-top: 6px;">SELL ALL</button>
                    </div>

                    <!-- Staking Section -->
                    <div style="margin: 25px 0 15px 0; padding-top: 20px; border-top: 2px solid #222;">
                        <h3 style="color: #ffaa33; margin: 0 0 10px 0; font-size: 1.2rem;">üè¶ Crypto Staking Bank</h3>
                        <p style="color: #888; font-size: 0.75rem; margin: 0 0 15px 0;">Lock your crypto to earn 0.1% APR every 2 seconds, paid directly to your cash balance!</p>
                    </div>

                    <!-- BTC Staking -->
                    <div style="background: rgba(247, 147, 26, 0.1); border: 1px solid #f7931a; border-radius: 8px; padding: 12px; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="color: #f7931a; font-weight: 800; font-size: 1.1rem;">‚Çø Bitcoin Staking</span>
                            <span style="color: #ffaa33; font-size: 0.8rem;" id="btc-apr-display">$0.00/hr</span>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span style="color: #888; font-size: 0.7rem;">Staked: </span>
                            <span style="color: #f7931a; font-family: monospace; font-weight: 800;" id="btc-staked-amount">0.00000000</span>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span style="color: #888; font-size: 0.7rem; text-transform: uppercase; display: block; margin-bottom: 5px;">Stake Amount</span>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;">
                                <button onclick="quickStake('BTC', 25)" style="background: #f7931a; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">25%</button>
                                <button onclick="quickStake('BTC', 50)" style="background: #f7931a; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">50%</button>
                                <button onclick="quickStake('BTC', 75)" style="background: #f7931a; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">75%</button>
                                <button onclick="quickStake('BTC', 100)" style="background: #f7931a; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">100%</button>
                            </div>
                        </div>
                        <div style="margin-bottom: 0px;">
                            <span style="color: #888; font-size: 0.7rem; text-transform: uppercase; display: block; margin-bottom: 5px;">Unstake Amount</span>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;">
                                <button onclick="quickUnstake('BTC', 25)" style="background: #333; color: #f7931a; border: 1px solid #f7931a; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">25%</button>
                                <button onclick="quickUnstake('BTC', 50)" style="background: #333; color: #f7931a; border: 1px solid #f7931a; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">50%</button>
                                <button onclick="quickUnstake('BTC', 75)" style="background: #333; color: #f7931a; border: 1px solid #f7931a; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">75%</button>
                                <button onclick="quickUnstake('BTC', 100)" style="background: #333; color: #f7931a; border: 1px solid #f7931a; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">100%</button>
                            </div>
                        </div>
                    </div>

                    <!-- ETH Staking -->
                    <div style="background: rgba(98, 126, 234, 0.1); border: 1px solid #627eea; border-radius: 8px; padding: 12px; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="color: #627eea; font-weight: 800; font-size: 1.1rem;">Œû Ethereum Staking</span>
                            <span style="color: #ffaa33; font-size: 0.8rem;" id="eth-apr-display">$0.00/hr</span>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span style="color: #888; font-size: 0.7rem;">Staked: </span>
                            <span style="color: #627eea; font-family: monospace; font-weight: 800;" id="eth-staked-amount">0.00000000</span>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span style="color: #888; font-size: 0.7rem; text-transform: uppercase; display: block; margin-bottom: 5px;">Stake Amount</span>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;">
                                <button onclick="quickStake('ETH', 25)" style="background: #627eea; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">25%</button>
                                <button onclick="quickStake('ETH', 50)" style="background: #627eea; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">50%</button>
                                <button onclick="quickStake('ETH', 75)" style="background: #627eea; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">75%</button>
                                <button onclick="quickStake('ETH', 100)" style="background: #627eea; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">100%</button>
                            </div>
                        </div>
                        <div style="margin-bottom: 0px;">
                            <span style="color: #888; font-size: 0.7rem; text-transform: uppercase; display: block; margin-bottom: 5px;">Unstake Amount</span>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;">
                                <button onclick="quickUnstake('ETH', 25)" style="background: #333; color: #627eea; border: 1px solid #627eea; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">25%</button>
                                <button onclick="quickUnstake('ETH', 50)" style="background: #333; color: #627eea; border: 1px solid #627eea; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">50%</button>
                                <button onclick="quickUnstake('ETH', 75)" style="background: #333; color: #627eea; border: 1px solid #627eea; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">75%</button>
                                <button onclick="quickUnstake('ETH', 100)" style="background: #333; color: #627eea; border: 1px solid #627eea; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">100%</button>
                            </div>
                        </div>
                    </div>

                    <!-- DOGE Staking -->
                    <div style="background: rgba(194, 166, 51, 0.1); border: 1px solid #c2a633; border-radius: 8px; padding: 12px; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="color: #c2a633; font-weight: 800; font-size: 1.1rem;">√ê Dogecoin Staking</span>
                            <span style="color: #ffaa33; font-size: 0.8rem;" id="doge-apr-display">$0.00/hr</span>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span style="color: #888; font-size: 0.7rem;">Staked: </span>
                            <span style="color: #c2a633; font-family: monospace; font-weight: 800;" id="doge-staked-amount">0.00</span>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span style="color: #888; font-size: 0.7rem; text-transform: uppercase; display: block; margin-bottom: 5px;">Stake Amount</span>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;">
                                <button onclick="quickStake('DOGE', 25)" style="background: #c2a633; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">25%</button>
                                <button onclick="quickStake('DOGE', 50)" style="background: #c2a633; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">50%</button>
                                <button onclick="quickStake('DOGE', 75)" style="background: #c2a633; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">75%</button>
                                <button onclick="quickStake('DOGE', 100)" style="background: #c2a633; color: #000; border: none; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">100%</button>
                            </div>
                        </div>
                        <div style="margin-bottom: 0px;">
                            <span style="color: #888; font-size: 0.7rem; text-transform: uppercase; display: block; margin-bottom: 5px;">Unstake Amount</span>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;">
                                <button onclick="quickUnstake('DOGE', 25)" style="background: #333; color: #c2a633; border: 1px solid #c2a633; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">25%</button>
                                <button onclick="quickUnstake('DOGE', 50)" style="background: #333; color: #c2a633; border: 1px solid #c2a633; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">50%</button>
                                <button onclick="quickUnstake('DOGE', 75)" style="background: #333; color: #c2a633; border: 1px solid #c2a633; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">75%</button>
                                <button onclick="quickUnstake('DOGE', 100)" style="background: #333; color: #c2a633; border: 1px solid #c2a633; padding: 8px; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 0.75rem;">100%</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<!-- Skill Tree Modal -->
<div id="skill-tree-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content skill-tree-modal">
        <div class="modal-header">
            <h2>üåü Skill Tree</h2>
            <button onclick="closeSkillTreeModal()" class="modal-close">√ó</button>
        </div>
        <div class="modal-body">
            <div style="text-align: center; margin-bottom: 15px;">
                <span style="font-size: 1.2rem; color: #00ff88; font-weight: bold;">
                    üî∑ <span id="skill-tokens-modal">0</span> Skill Tokens Available
                </span>
            </div>

            <!-- Milestone Progress -->
            <div id="milestone-progress" style="margin-bottom: 20px; padding: 15px; background: rgba(0,255,136,0.1); border-radius: 8px; border: 1px solid rgba(0,255,136,0.3); text-align: center;">
                <div style="font-size: 0.9rem; color: #00ff88; font-weight: bold;">
                    Reach milestones to earn Skill Tokens!
                </div>
            </div>

            <div id="skill-tree-container"></div>
        </div>
    </div>
</div>

<!-- Footer Disclaimer -->
<div style="position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.9); padding: 8px; text-align: center; border-top: 1px solid #333; z-index: 9999;">
    <p style="margin: 0; font-size: 0.7rem; color: #888;">
        <strong style="color: #f7931a;">18+ Only</strong> | This is a simulation game with <strong>NO real cryptocurrency or monetary value</strong>. All assets are virtual and for entertainment only.
        <span style="margin: 0 8px;">|</span>
        <a href="#" onclick="openPrivacyModal(); switchPolicyTab('privacy'); return false;" style="color: #f7931a; text-decoration: underline; cursor: pointer;">Privacy Policy</a>
        <span style="margin: 0 8px;">|</span>
        <a href="#" onclick="openPrivacyModal(); switchPolicyTab('cookies'); return false;" style="color: #f7931a; text-decoration: underline; cursor: pointer;">Cookie Policy</a>
        <span style="margin: 0 8px;">|</span>
        <a href="#" onclick="openPrivacyModal(); switchPolicyTab('terms'); return false;" style="color: #f7931a; text-decoration: underline; cursor: pointer;">Terms & Conditions</a>
        <span style="margin: 0 8px;">|</span>
        <a href="#" class="termly-display-preferences" style="color: #f7931a; text-decoration: underline; cursor: pointer;">Consent Preferences</a>
        <span style="margin: 0 8px;">|</span>
        <a href="#" onclick="openPrivacyModal(); switchPolicyTab('contact'); return false;" style="color: #f7931a; text-decoration: underline; cursor: pointer;">Contact</a>
        <span style="margin: 0 8px;">|</span>
        <span style="color: #666;">Idle BTC Miner 2026 - Aaron Khan</span>
    </p>
</div>

<!-- Inline Policy Tab Switching Functions -->
<script>
    // Privacy modal functions - defined early so footer links work
    function openPrivacyModal() {
        document.getElementById('privacy-modal').style.display = 'flex';
    }

    function closePrivacyModal() {
        document.getElementById('privacy-modal').style.display = 'none';
    }

    // Onboarding modal functions
    async function acceptOnboarding() {
        window.safeStorage.setItem('ageDisclaimerAccepted', 'true');
        window.safeStorage.setItem('termsAccepted', 'true');

        // Save consent to Firebase if user is logged in
        if (window.auth && window.auth.currentUser) {
            console.log('üíæ Saving onboarding consent to Firebase...');
            if (typeof window.saveConsentToFirebase === 'function') {
                try {
                    await window.saveConsentToFirebase(window.auth.currentUser.uid);
                    console.log('‚úÖ Onboarding consent saved to Firebase');
                } catch (error) {
                    console.error('‚ùå Failed to save consent:', error);
                }
            }
        }

        // Hide onboarding modal
        const onboardingModal = document.getElementById('onboarding-modal');
        if (onboardingModal) {
            onboardingModal.style.display = 'none';
        }

        // Ensure main layout is visible and interactive with all CSS resets
        const mainLayout = document.getElementById('main-layout');
        if (mainLayout) {
            // Clear all inline styles that might be interfering
            mainLayout.style.cssText = '';

            // Reset to default grid layout
            mainLayout.style.display = 'grid';
            mainLayout.style.gridTemplateColumns = '7fr 3fr';
            mainLayout.style.gap = '20px';
            mainLayout.style.height = 'calc(100vh - 40px)';
            mainLayout.style.boxSizing = 'border-box';
            mainLayout.style.position = 'relative';
            mainLayout.style.zIndex = '1';
            mainLayout.style.pointerEvents = 'auto';
            mainLayout.style.userSelect = 'auto';
            mainLayout.style.visibility = 'visible';
            mainLayout.style.opacity = '1';

            // Force layout recalculation
            void mainLayout.offsetHeight;
            void mainLayout.offsetWidth;
        }

        // Refresh all panels
        setTimeout(() => {
            const panels = document.querySelectorAll('.panel');
            panels.forEach(panel => {
                // Reset panel styles
                panel.style.visibility = 'visible';
                panel.style.display = 'flex';
                panel.style.flexDirection = 'column';
                panel.style.opacity = '1';

                // Force reflow
                void panel.offsetHeight;
            });

            // Trigger chart resize if it exists
            if (window.nwChartInstance && typeof window.nwChartInstance.resize === 'function') {
                try {
                    window.nwChartInstance.resize();
                } catch (e) {
                    console.warn('Chart resize failed:', e);
                }
            }

            // Update display if function exists
            if (typeof window.updateDisplay === 'function') {
                try {
                    window.updateDisplay();
                } catch (e) {
                    console.warn('updateDisplay failed:', e);
                }
            }
        }, 50);

        // NOTE: Cookie consent will be checked automatically if needed
        // Don't call it here as it's already been checked on page load
    }

    function declineOnboarding() {
        alert('You must accept the Age Requirement and Terms & Conditions to use this service.');
    }

    function switchPolicyTab(tab) {
        const iframe = document.getElementById('privacy-iframe');
        const privacyTab = document.getElementById('policy-tab-privacy');
        const cookiesTab = document.getElementById('policy-tab-cookies');
        const termsTab = document.getElementById('policy-tab-terms');
        const contactTab = document.getElementById('policy-tab-contact');

        // Reset all tabs to inactive state
        privacyTab.style.background = '#ddd';
        privacyTab.style.color = '#000';
        cookiesTab.style.background = '#ddd';
        cookiesTab.style.color = '#000';
        termsTab.style.background = '#ddd';
        termsTab.style.color = '#000';
        contactTab.style.background = '#ddd';
        contactTab.style.color = '#000';

        if (tab === 'privacy') {
            iframe.src = 'privacy.html?v=20260123040255';
            privacyTab.style.background = '#f7931a';
            privacyTab.style.color = '#000';
        } else if (tab === 'cookies') {
            iframe.src = 'cookies.html?v=20260123040255';
            cookiesTab.style.background = '#f7931a';
            cookiesTab.style.color = '#000';
        } else if (tab === 'terms') {
            iframe.src = 'terms.html?v=20260123040255';
            termsTab.style.background = '#f7931a';
            termsTab.style.color = '#000';
        } else if (tab === 'contact') {
            iframe.src = 'contact.html?v=20260123040255';
            contactTab.style.background = '#f7931a';
            contactTab.style.color = '#000';
        }
    }

    // Check if onboarding (age + terms) has been accepted on page load
    window.addEventListener('load', function() {
        const ageAccepted = window.safeStorage.getItem('ageDisclaimerAccepted');
        const termsAccepted = window.safeStorage.getItem('termsAccepted');
        const bothAccepted = ageAccepted && termsAccepted;

        console.log('üîç Onboarding check on load:', { ageAccepted, termsAccepted, bothAccepted });

        // ONLY show if EITHER age OR terms is missing (i.e., NOT both accepted)
        if (!bothAccepted) {
            // Only show onboarding modal if login screen is not visible
            // (don't show during login/register, only after sign in)
            setTimeout(() => {
                const loginScreen = document.getElementById('login-screen');
                const isLoginVisible = loginScreen && loginScreen.style.display !== 'none';

                // If login screen is visible, don't show onboarding yet
                if (!isLoginVisible) {
                    console.log('üìã Showing onboarding modal (not both accepted yet)');
                    document.getElementById('onboarding-modal').style.display = 'flex';
                } else {
                    console.log('üìã Skipping onboarding modal (login screen visible)');
                }
            }, 500);
        } else {
            console.log('‚úÖ Onboarding already complete - not showing modal');
            // Make sure modal is hidden
            document.getElementById('onboarding-modal').style.display = 'none';
        }
    });
</script>

<!-- Cookie Consent Bottom Banner -->
<div id="cookie-consent-banner" style="display: none; position: fixed; bottom: 50px; left: 0; width: 100%; background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); border-top: 2px solid #f7931a; padding: 12px 20px; z-index: 10001; box-shadow: 0 -2px 15px rgba(247,147,26,0.3);">
    <div style="max-width: 1400px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; gap: 20px; flex-wrap: wrap;">
        <div style="flex: 1; min-width: 200px;">
            <p style="color: #fff; font-size: 0.85rem; margin: 0 0 6px 0; line-height: 1.3;">
                <strong style="color: #f7931a;">üç™ Cookies:</strong> We use cookies for analytics and to improve your experience.
                <a href="#" onclick="openPrivacyModal(); switchPolicyTab('cookies'); return false;" style="color: #f7931a; text-decoration: underline; margin-left: 5px;">Learn more</a>
            </p>
        </div>
        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
            <button onclick="acceptAllCookies()" style="background: #f7931a; color: #000; border: none; padding: 6px 14px; font-weight: 700; border-radius: 6px; cursor: pointer; font-size: 0.8rem; transition: 0.2s; white-space: nowrap;">
                Accept All
            </button>
            <button onclick="acceptEssentialOnly()" style="background: #555; color: #fff; border: none; padding: 6px 14px; font-weight: 700; border-radius: 6px; cursor: pointer; font-size: 0.8rem; transition: 0.2s; white-space: nowrap;">
                Essential Only
            </button>
        </div>
    </div>
</div>

<!-- Cookie Consent JavaScript -->
<script>
    // Check if user has already made a cookie choice
    function checkCookieConsent() {
        const consent = window.safeStorage.getItem('cookieConsent');
        // Only show if user hasn't made a choice previously
        if (!consent) {
            // Show banner after age disclaimer and terms acceptance
            // Wait for those modals to be accepted first
            setTimeout(() => {
                const ageAccepted = window.safeStorage.getItem('ageDisclaimerAccepted');
                const termsAccepted = window.safeStorage.getItem('termsAccepted');

                // Only show cookie modal if age and terms have been accepted
                if (ageAccepted && termsAccepted) {
                    const banner = document.getElementById('cookie-consent-banner');
                    if (banner) {
                        banner.style.display = 'flex';
                    }
                } else {
                    // Check again in 1 second if they haven't accepted yet
                    setTimeout(checkCookieConsent, 1000);
                }
            }, 500);
        }
    }

    // Accept all cookies
    async function acceptAllCookies() {
        window.safeStorage.setItem('cookieConsent', 'all');
        window.safeStorage.setItem('cookieConsentDate', new Date().toISOString());

        // Enable Google Analytics and other tracking
        window['ga-disable-G-2H559N5J64'] = false;

        // Hide modal
        document.getElementById('cookie-consent-banner').style.display = 'none';

        // Optional: Trigger Termly consent if available
        if (typeof window.termlyConsent !== 'undefined') {
            window.termlyConsent('accept');
        }

        // Save consent to Firebase if user is logged in
        if (window.auth && window.auth.currentUser) {
            console.log('üíæ Saving cookie consent to Firebase...');
            if (typeof window.saveConsentToFirebase === 'function') {
                try {
                    await window.saveConsentToFirebase(window.auth.currentUser.uid);
                    console.log('‚úÖ Cookie consent saved to Firebase');
                } catch (error) {
                    console.error('‚ùå Failed to save consent:', error);
                }
            }
        }

        console.log('All cookies accepted');
    }

    // Accept essential cookies only
    async function acceptEssentialOnly() {
        window.safeStorage.setItem('cookieConsent', 'essential');
        window.safeStorage.setItem('cookieConsentDate', new Date().toISOString());

        // Disable Google Analytics
        window['ga-disable-G-2H559N5J64'] = true;

        // Hide banner
        document.getElementById('cookie-consent-banner').style.display = 'none';

        // Optional: Trigger Termly essential only if available
        if (typeof window.termlyConsent !== 'undefined') {
            window.termlyConsent('essential');
        }

        // Save consent to Firebase if user is logged in
        if (window.auth && window.auth.currentUser) {
            console.log('üíæ Saving cookie consent to Firebase...');
            if (typeof window.saveConsentToFirebase === 'function') {
                try {
                    await window.saveConsentToFirebase(window.auth.currentUser.uid);
                    console.log('‚úÖ Cookie consent saved to Firebase');
                } catch (error) {
                    console.error('‚ùå Failed to save consent:', error);
                }
            }
        }

        console.log('Essential cookies only');
    }

    // Open Termly cookie settings or custom preferences
    function openCookieSettings() {
        // Try to trigger Termly settings if available
        const termlyButton = document.querySelector('.termly-display-preferences');
        if (termlyButton) {
            termlyButton.click();
        } else {
            // Fallback: show custom settings or just accept essential
            if (confirm('Would you like to accept all cookies?\n\nClick OK to accept all cookies.\nClick Cancel to use essential cookies only.')) {
                acceptAllCookies();
            } else {
                acceptEssentialOnly();
            }
        }
    }

    // Revoke consent (for testing or user preference changes)
    function revokeCookieConsent() {
        localStorage.removeItem('cookieConsent');
        localStorage.removeItem('cookieConsentDate');
        document.getElementById('cookie-consent-banner').style.display = 'block';
    }

    // Check consent on page load
    window.addEventListener('DOMContentLoaded', checkCookieConsent);
</script>

<!-- Load skill tree system first so its functions are available to game.js -->
<script src="skilltree.js?v=20260123012223"></script>

<!-- Load main game after skill tree functions are defined -->
<script src="game.js?v=20260123060902"></script>
<script>
    // Debug: Verify switchTab is loaded
    console.log('DEBUG: After game.js load, switchTab type:', typeof window.switchTab);
    if (typeof window.switchTab !== 'function') {
        console.error('ERROR: switchTab not loaded! Creating fallback...');
        // Temporary fallback for debugging
        window.switchTab = function(tab, event) {
            console.log('Fallback switchTab called with:', tab);
        };
    }

    // Mute button now uses inline onclick with safety check
</script>

<!-- Load staking system after main game variables are defined -->
<script src="staking.js?v=20260123012223"></script>

<!-- Load leaderboard system -->
<script src="leaderboard.js?v=20260123063136"></script>

<!-- Mobile Layout Enforcer -->
<script>
    // Ensure mobile layout is applied correctly
    function enforceMobileLayout() {
        const width = window.innerWidth;
        const height = window.innerHeight;
        const mainLayout = document.getElementById('main-layout');

        // Breakpoint at 1440px - below this should be mobile layout
        const isMobileWidth = width <= 1440;
        const isPortrait = width < height;
        const shouldStackLayout = isMobileWidth || isPortrait;

        if (mainLayout) {
            if (shouldStackLayout) {
                // Mobile layout (single column)
                if (mainLayout.style.display !== 'flex') {
                    console.log('üì± ENFORCING MOBILE LAYOUT:');
                    console.log('  Window: ' + width + 'x' + height + 'px');
                    console.log('  Mobile Width (<=1440px or portrait): ' + true);

                    // Don't override inline styles - CSS media queries handle this
                    // Just ensure nothing is forcing grid layout
                    mainLayout.classList.remove('desktop-layout');
                    mainLayout.classList.add('mobile-layout');
                }
            } else {
                // Desktop layout (2 columns)
                if (mainLayout.style.display !== 'grid') {
                    console.log('üñ•Ô∏è SWITCHING TO DESKTOP LAYOUT:');
                    console.log('  Window: ' + width + 'x' + height + 'px');

                    mainLayout.classList.remove('mobile-layout');
                    mainLayout.classList.add('desktop-layout');
                }
            }
        }
    }

    // Run on load and resize
    window.addEventListener('DOMContentLoaded', enforceMobileLayout);
    window.addEventListener('resize', enforceMobileLayout);
    // Also run immediately with minimal delay to avoid flash
    setTimeout(enforceMobileLayout, 10);
</script>

<!-- Initialize Firebase -->
<script>
    // Function to show login screen
    function showLoginScreen() {
        const loginScreen = document.getElementById('login-screen');
        if (loginScreen) {
            loginScreen.style.display = 'flex';
        }
    }

    // Make it globally available
    window.showLoginScreen = showLoginScreen;

    // Initialize Firebase when page loads
    window.addEventListener('DOMContentLoaded', () => {
        console.log('üöÄ Initializing Firebase...');

        // Initialize Firebase
        const firebaseReady = initializeFirebase();

        if (firebaseReady) {
            console.log('‚úÖ Firebase ready!');

            // Setup authentication listener
            if (window.setupAuthListener) {
                setupAuthListener();
            }

            // Start auto-save
            startAutoSave();

            // Note: Manual sync button is now integrated into user UI
            console.log('‚úÖ Manual save integrated into user menu');

            // Check if user is already logged in (Firebase persists auth state)
            // If not logged in, show login screen
            if (!auth.currentUser) {
                console.log('No user logged in - showing login screen');
                // Show login screen first on initial load
                // User must login or play as guest
                // Show game in background (blurred and disabled)
                document.getElementById('login-screen').style.display = 'flex';
                const mainLayout = document.getElementById('main-layout');
                mainLayout.style.display = 'grid'; // Show as background
                mainLayout.style.pointerEvents = 'none'; // Disable interaction
                mainLayout.style.userSelect = 'none'; // Disable text selection
            } else {
                console.log('User already logged in - enabling game');
                // User is already logged in, enable the game
                document.getElementById('login-screen').style.display = 'none';
                const mainLayout = document.getElementById('main-layout');
                mainLayout.style.display = 'grid';
                mainLayout.style.pointerEvents = 'auto'; // Enable interaction
                mainLayout.style.userSelect = 'auto'; // Enable text selection
            }
        } else {
            console.warn('‚ö†Ô∏è Firebase not initialized - running in offline mode');
            // Allow game to run without Firebase in offline mode
            document.getElementById('login-screen').style.display = 'none';
            const mainLayout = document.getElementById('main-layout');
            mainLayout.style.display = 'grid';
            mainLayout.style.pointerEvents = 'auto'; // Enable interaction
            mainLayout.style.userSelect = 'auto'; // Enable text selection
        }
    });

    // Clear game save data on page load to prevent loading other account's data
    // But preserve user preferences like consent and dismissed instructions
    console.log('üîÑ Page loaded - clearing previous game session data');
    localStorage.removeItem('satoshiTerminalSave');

    // Save game before user closes/refreshes page
    window.addEventListener('beforeunload', (e) => {
        if (typeof auth !== 'undefined' && auth && auth.currentUser) {
            saveGameToCloud();
        }
    });
</script>

</body>

</html>
