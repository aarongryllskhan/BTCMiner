!function(){"use strict";class i{constructor(){this.canvas=null,this.ctx=null,this.coins=[],this.isRunning=!1,this.lastHashRate=0,this.spawnRate=0,this.spawnRates={btc:0,eth:0,doge:0,usd:0},this.maxCoins=20,this.lastAnimationTime=0,this.usdWarningLogged=!1,this.coinTypes=[{name:"btc",src:"bitcointoken.png",color:"#f7931a"},{name:"eth",src:"ethcoin.png",color:"#627eea"},{name:"doge",src:"dogecoin.png",color:"#c2a633"},{name:"usd",src:"dollar2.png",color:"#ffdd00"},{name:"usd_stack",src:"dollarstack.png",color:"#ffdd00"},{name:"usd_stack_2",src:"dollarstack-2.png",color:"#ffdd00"}],this.images={},this.imagesLoaded=!1,this.loadImages()}loadImages(){let i=0;const n=this.coinTypes.length;this.coinTypes.forEach(t=>{const o=new Image;o.crossOrigin="anonymous";const a=a=>{console.warn(`[CoinRain] ✗ Failed to load: ${t.src}`,a),console.error(`[CoinRain] Error loading ${t.src} - Status: ${o.status}`),i++,i===n&&(this.imagesLoaded=!0,console.log("[CoinRain] Using fallback colored circles"))};o.onload=()=>{i++,console.log(`[CoinRain] ✓ Loaded: ${t.src} (${o.naturalWidth}x${o.naturalHeight})`),i===n&&(this.imagesLoaded=!0,console.log("[CoinRain] All images loaded!"))},o.onerror=a,o.onabort=()=>{console.error(`[CoinRain] Abort loading: ${t.src}`),a(new Error("Abort"))},console.log(`[CoinRain] Attempting to load: ${t.src}`),o.src=t.src,this.images[t.name]=o}),setTimeout(()=>{i<n&&(console.warn("[CoinRain] Timeout after 5s - using fallback circles"),this.coinTypes.forEach(i=>{const n=this.images[i.name];n&&n.complete&&0!==n.naturalHeight||console.error(`[CoinRain] Failed to load: ${i.src}`)}),this.imagesLoaded=!0)},5e3)}initialize(){if(this.canvas)return;const i=document.createElement("canvas");i.id="coin-rain-canvas",i.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:500;display:block;background:transparent;",i.width=window.innerWidth,i.height=window.innerHeight,document.body.insertBefore(i,document.body.firstChild),this.canvas=i,this.ctx=i.getContext("2d",{alpha:!0}),console.log("[CoinRain] Canvas initialized:",i.width,"x",i.height),window.addEventListener("resize",()=>this.onWindowResize()),this.startAnimation()}onWindowResize(){this.canvas&&(this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight)}startAnimation(){this.isRunning||(this.isRunning=!0,this.lastAnimationTime=Date.now(),this.animate())}stopAnimation(){this.isRunning=!1}pauseAnimation(){this.isRunning=!1}resumeAnimation(){this.isRunning||(this.isRunning=!0,this.lastAnimationTime=Date.now(),this.animate())}updateHashRate(i,n,t){const o=i+n+t;this.lastHashRate=o,this.spawnRate=0,this.spawnRates.btc=0,this.spawnRates.eth=0,this.spawnRates.doge=0,this.spawnRates.usd=0}spawnCoin(i=null,n=!1){if(this.coins.length>=this.maxCoins)return;let t,o;i?(t=this.coinTypes.find(n=>n.name===i),t||(t=this.coinTypes[Math.floor(Math.random()*this.coinTypes.length)])):t=this.coinTypes[Math.floor(Math.random()*this.coinTypes.length)],o="usd"===t.name||"usd_stack"===t.name||"usd_stack_2"===t.name?90:24;const a=n?3:2,e=n?2.5:1.5,s=n?.2:.1,c=window.innerWidth<=768,h=c?this.canvas.width:.45*this.canvas.width,d={x:Math.random()*h,y:-100*Math.random()-80,vx:(Math.random()-.5)*a,vy:.5+Math.random()*e,rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*s,size:o,opacity:1,type:t.name,lifetime:0,maxLifetime:c?350:1e3,isClickCoin:n};this.coins.push(d)}updateCoins(i){for(let n=this.coins.length-1;n>=0;n--){const t=this.coins[n];t.x+=t.vx,t.y+=t.vy,t.rotation+=t.rotationSpeed,t.lifetime+=i;if(t.rotationSpeed>.1||t.rotationSpeed<-.1){t.vy+=.15,t.vx*=.97;const i=t.lifetime/t.maxLifetime;t.opacity=Math.max(0,1-i)}else if(t.isClickCoin){t.vy+=.25,t.vx*=.99;const i=t.lifetime/t.maxLifetime;t.opacity=Math.max(0,1-i)}else{t.vy+=.08,t.vx*=.99;const i=this.canvas.height/2;t.y<i?t.opacity=1:t.y<i+100?t.opacity=1-(t.y-i)/100:t.opacity=0}(t.y>this.canvas.height+50||t.lifetime>t.maxLifetime)&&this.coins.splice(n,1)}}drawCoins(){this.coins.forEach(i=>{this.ctx.save(),this.ctx.globalAlpha=i.opacity,this.ctx.translate(i.x,i.y),this.ctx.rotate(i.rotation);const n=this.images[i.type],t=this.coinTypes.find(n=>n.name===i.type)?.color||"#fff";if(n&&n.complete&&0!==n.naturalHeight)try{this.ctx.drawImage(n,-i.size/2,-i.size/2,i.size,i.size)}catch(n){console.warn(`[CoinRain] Failed to draw image for ${i.type}:`,n),this.drawFallback(i.size,t)}else"usd"!==i.type||this.usdWarningLogged||(console.log(`[CoinRain] USD coin using fallback - img exists: ${!!n}, complete: ${n?.complete}, naturalHeight: ${n?.naturalHeight}`),this.usdWarningLogged=!0),this.drawFallback(i.size,t);this.ctx.restore()})}drawFallback(i,n){const t=i/2;if("#ffdd00"===n){const n=1.5*i,t=.6*i;this.ctx.fillStyle="#22dd44",this.ctx.fillRect(-n/2,-t/2,n,t)}else this.ctx.fillStyle=n,this.ctx.beginPath(),this.ctx.arc(0,0,t,0,2*Math.PI),this.ctx.fill()}animate(){if(!this.isRunning)return;const i=Date.now(),n=Math.max(1,i-this.lastAnimationTime);this.lastAnimationTime=i;const t=Math.floor(this.spawnRates.btc/1e3*n),o=Math.floor(this.spawnRates.eth/1e3*n),a=Math.floor(this.spawnRates.doge/1e3*n);for(let i=0;i<t;i++)this.spawnCoin("btc");for(let i=0;i<o;i++)this.spawnCoin("eth");for(let i=0;i<a;i++)this.spawnCoin("doge");this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.updateCoins(n),this.drawCoins(),requestAnimationFrame(()=>this.animate())}}function n(){window.coinRainSystem||(window.coinRainSystem=new i,window.coinRainSystem.initialize(),console.log("[CoinRain] Initialization complete"))}window.CoinRainSystem=i,window.coinRainSystem=null,window.initializeCoinRain=n,window.updateCoinRain=function(i,t,o){window.coinRainSystem||n(),window.coinRainSystem.updateHashRate(i,t,o)},window.spawnExplosionCoins=function(i,t){window.coinRainSystem||n();for(let n=0;n<t;n++){const n=Math.random()*Math.PI*2,t=8+12*Math.random(),o={x:window.innerWidth/2,y:window.innerHeight/2,vx:Math.cos(n)*t,vy:Math.sin(n)*t,rotation:Math.random()*Math.PI*2,rotationSpeed:.5*(Math.random()-.5),size:"usd"===i?18+8*Math.random():6+4*Math.random(),opacity:1,type:i,lifetime:0,maxLifetime:1e3};window.coinRainSystem.coins.push(o)}},window.pauseCoinRain=function(){window.coinRainSystem&&window.coinRainSystem.pauseAnimation()},window.resumeCoinRain=function(){window.coinRainSystem&&window.coinRainSystem.resumeAnimation()},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{console.log("[CoinRain] DOMContentLoaded fired"),setTimeout(n,100)}):(console.log("[CoinRain] DOM already loaded, initializing soon..."),setTimeout(function i(){document.body?(console.log("[CoinRain] Initializing now..."),n()):(console.log("[CoinRain] Body not ready, retrying..."),setTimeout(i,50))},100)),console.log("[CoinRain] Script loaded and setup complete"),window._coinRainLoaded=!0}(),"function"!=typeof initializeCoinRain&&console.warn("[CoinRain] IIFE failed to execute - attempting direct init");