let stakedBTC=0,stakedETH=0,stakedDOGE=0;const APR_RATE=1e-4,APR_INTERVAL=2e3;let stakingInterval=null;function initStaking(){stakingInterval&&clearInterval(stakingInterval),stakingInterval=setInterval(processStakingEarnings,2e3),updateStakingAPRDisplay()}function getStakingAPRBonus(){let t=0;return"undefined"!=typeof metaUpgrades&&Object.entries(metaUpgrades).forEach(([e,a])=>{if(a.purchased&&e.includes("staking_apy")){const a=e.match(/\d+$/);if(a){const e=parseInt(a[0]);t+=.005*Math.pow(1.15,e-1)}}}),t}function updateStakingAPRDisplay(){const t=.01+getStakingAPRBonus(),e=document.getElementById("staking-apr-rate");e&&(e.textContent=t.toFixed(2)+"%")}function processStakingEarnings(){let t=0,e=0,a=0,n=0;const s="function"==typeof getStakingBonus?getStakingBonus():1,o=1e-4+getStakingAPRBonus()/100;if(stakedBTC>0){const a=stakedBTC*o*s;e=a;t+=a*btcPrice}if(stakedETH>0){const e=stakedETH*o*s;a=e;t+=e*ethPrice}if(stakedDOGE>0){const e=stakedDOGE*o*s;n=e;t+=e*dogePrice}if(t>0&&(dollarBalance+=t,lifetimeEarnings+=t,sessionEarnings+=t,"function"==typeof window.rugpullAddEarnings?(console.log("[STAKING] Adding to rugpull tracker:",t),window.rugpullAddEarnings(t)):console.log("[STAKING] âœ— rugpullAddEarnings NOT available"),e>0&&(btcLifetime+=e),a>0&&(ethLifetime+=a),n>0&&(dogeLifetime+=n)),"function"==typeof getTokenGenerationRate){const t=getTokenGenerationRate()/2;t>0&&"undefined"!=typeof rugpullCurrency&&"undefined"!=typeof window&&void 0!==window.rugpullCurrency&&(window.rugpullCurrency+=t),updateUI()}}function stakeCrypto(t,e){if(e<=0||e>100)return void alert("Invalid percentage! Must be between 1-100%");const a=e/100,n=0===stakedBTC&&0===stakedETH&&0===stakedDOGE;switch(t){case"BTC":if(btcBalance<=0)return void alert("No Bitcoin available to stake!");const t=btcBalance*a;btcBalance-=t,stakedBTC+=t;break;case"ETH":if(ethBalance<=0)return void alert("No Ethereum available to stake!");const e=ethBalance*a;ethBalance-=e,stakedETH+=e;break;case"DOGE":if(dogeBalance<=0)return void alert("No Dogecoin available to stake!");const n=dogeBalance*a;dogeBalance-=n,stakedDOGE+=n;break;default:return void alert("Invalid cryptocurrency!")}n&&"function"==typeof markFirstStake&&markFirstStake(),updateUI(),updateStakingUI(),saveGame(),playUpgradeSound()}function unstakeCrypto(t,e){if(e<=0||e>100)return void alert("Invalid percentage! Must be between 1-100%");const a=e/100;switch(t){case"BTC":if(stakedBTC<=0)return void alert("No staked Bitcoin to unstake!");const t=stakedBTC*a;stakedBTC-=t,btcBalance+=t;break;case"ETH":if(stakedETH<=0)return void alert("No staked Ethereum to unstake!");const e=stakedETH*a;stakedETH-=e,ethBalance+=e;break;case"DOGE":if(stakedDOGE<=0)return void alert("No staked Dogecoin to unstake!");const n=stakedDOGE*a;stakedDOGE-=n,dogeBalance+=n;break;default:return void alert("Invalid cryptocurrency!")}updateUI(),updateStakingUI(),saveGame(),playUpgradeSound()}function updateStakingUI(){let t=1e-4,e=1;if("function"==typeof getSkillBonus){t=1e-4*(1+(getSkillBonus("staking_apy")||0)/100),e=1+(getSkillBonus("earnings_boost")||0)/100}const a=document.getElementById("btc-staked-amount"),n=document.getElementById("btc-apr-display");if(a&&(a.textContent="function"==typeof formatCryptoYield?formatCryptoYield(stakedBTC):stakedBTC.toFixed(8)),n&&stakedBTC>0){const a=1800*(stakedBTC*t*btcPrice*e);n.textContent=`$${"function"==typeof formatNumberForDisplay?formatNumberForDisplay(a):a.toFixed(2)}/hr`}else n&&(n.textContent="$0.00/hr");const s=document.getElementById("eth-staked-amount"),o=document.getElementById("eth-apr-display");if(s&&(s.textContent="function"==typeof formatCryptoYield?formatCryptoYield(stakedETH):stakedETH.toFixed(8)),o&&stakedETH>0){const a=1800*(stakedETH*t*ethPrice*e);o.textContent=`$${"function"==typeof formatNumberForDisplay?formatNumberForDisplay(a):a.toFixed(2)}/hr`}else o&&(o.textContent="$0.00/hr");const i=document.getElementById("doge-staked-amount"),d=document.getElementById("doge-apr-display");if(i&&(i.textContent="function"==typeof formatCryptoYield?formatCryptoYield(stakedDOGE):stakedDOGE.toFixed(2)),d&&stakedDOGE>0){const a=1800*(stakedDOGE*t*dogePrice*e);d.textContent=`$${"function"==typeof formatNumberForDisplay?formatNumberForDisplay(a):a.toFixed(2)}/hr`}else d&&(d.textContent="$0.00/hr")}function quickStake(t,e){stakeCrypto(t,e)}function quickUnstake(t,e){unstakeCrypto(t,e)}function stakeAllBTC(t){btcBalance>0&&(stakeCrypto("BTC",100),t&&void 0!==t.classList&&(t.classList.add("sell-success"),setTimeout(()=>t.classList.remove("sell-success"),250)))}function stakeAllETH(t){ethBalance>0&&(stakeCrypto("ETH",100),t&&void 0!==t.classList&&(t.classList.add("sell-success"),setTimeout(()=>t.classList.remove("sell-success"),250)))}function stakeAllDOGE(t){dogeBalance>0&&(stakeCrypto("DOGE",100),t&&void 0!==t.classList&&(t.classList.add("sell-success"),setTimeout(()=>t.classList.remove("sell-success"),250)))}function getStakingData(){return{stakedBTC:stakedBTC,stakedETH:stakedETH,stakedDOGE:stakedDOGE}}function loadStakingData(t){t&&(stakedBTC=t.stakedBTC||0,stakedETH=t.stakedETH||0,stakedDOGE=t.stakedDOGE||0)}function getTotalStakedValue(){return stakedBTC*btcPrice+stakedETH*ethPrice+stakedDOGE*dogePrice}window.updateStakingUI=updateStakingUI;
