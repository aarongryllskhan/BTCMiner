<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Function Test</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a1a;
            color: #0f0;
        }
        .test {
            margin: 10px 0;
            padding: 10px;
            background: #000;
            border: 1px solid #333;
        }
        .pass { color: #0f0; }
        .fail { color: #f00; }
    </style>
</head>
<body>
    <h1>Firebase Function Availability Test</h1>
    <p>Open browser console (F12) to see detailed logs</p>
    <div id="results"></div>

    <script>
        function runTests() {
            const results = document.getElementById('results');
            const tests = [
                { name: 'window.registerUser', func: window.registerUser },
                { name: 'window.loginUser', func: window.loginUser },
                { name: 'window.loginWithGoogle', func: window.loginWithGoogle },
                { name: 'window.logoutUser', func: window.logoutUser },
                { name: 'window.playAsGuest', func: window.playAsGuest },
                { name: 'window.resetPassword', func: window.resetPassword },
                { name: 'window.linkGuestToEmail', func: window.linkGuestToEmail },
                { name: 'window.saveGameToCloud', func: window.saveGameToCloud },
                { name: 'window.loadGameFromCloud', func: window.loadGameFromCloud },
                { name: 'window.setupAuthListener', func: window.setupAuthListener },
                { name: 'window.auth (Firebase Auth)', obj: window.auth },
                { name: 'window.db (Firebase Firestore)', obj: window.db }
            ];

            results.innerHTML = '';

            tests.forEach(test => {
                const value = test.func || test.obj;
                const exists = typeof value !== 'undefined';
                const isFunction = typeof value === 'function';
                const isObject = typeof value === 'object' && value !== null;

                let status = '';
                let statusClass = '';

                if (test.func) {
                    status = exists && isFunction ? '✓ PASS - Function exists' : '✗ FAIL - Function not found';
                    statusClass = exists && isFunction ? 'pass' : 'fail';
                } else {
                    status = exists && isObject ? '✓ PASS - Object exists' : '✗ FAIL - Object not found';
                    statusClass = exists && isObject ? 'pass' : 'fail';
                }

                const div = document.createElement('div');
                div.className = `test ${statusClass}`;
                div.innerHTML = `<strong>${test.name}</strong>: <span class="${statusClass}">${status}</span><br>Type: ${typeof value}`;
                results.appendChild(div);

                console.log(`${test.name}: ${typeof value}`, value);
            });
        }

        // Run tests after a short delay to allow Firebase to load
        setTimeout(runTests, 1000);

        // Also provide a button to manually re-run
        document.body.innerHTML += '<button onclick="runTests()" style="margin-top: 20px; padding: 10px 20px; background: #f7931a; color: #000; border: none; cursor: pointer; font-weight: bold;">Re-run Tests</button>';
    </script>
</body>
</html>
